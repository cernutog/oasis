openapi: 3.1.0
info:
  version: '5.0.7'
  title: EBA CLEARING FPAD
  description: |
    FPAD API for interacting with the FPAD functionality for Prevention and
    Detection assessments.
  contact:
    name: EBA CLEARING
    url: https://www.ebaclearing.eu
servers:
  - url: /fpad
    description: 'Server base path'
security: []
tags:
  - name: Prevention
    description: Fraud prevention operations
  - name: Detection
    description: Fraud detection operations
  - name: Feedback
    description: Risk assessment feedback operations
  - name: Insight Notifications
    description: Transaction and Account Insight Notification (TAIN) operations
  - name: EDS
    description: EDS operations
paths:
  /v1/accounts/assessments:
    post:
      tags:
        - Prevention
      summary: Perform Account Assessment
      description: |
        This operation creates a risk assessment for an account, identified by an IBAN. 
        It returns the results of the risk assessment in a *RiskInfoArray* that provides the outcomes for all the models performed as part of the risk assessment.  The requestor can define the list of models that will be performed in the risk assessment. If the models are
        not defined then a default set of models will be performed, and results returned.

        As FPAD adapts to changing transactional behaviour, the returned risk
        assessment may change for different invocations of the API for the same
        account.
      operationId: create-account-assessment
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
      requestBody:
        description: Structure of a FPAD account assessment request.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                accountName:
                  type: string
                  description: Name associated with the Account has to be assessed.
                accountBic:
                  $ref: '#/components/schemas/Bic'
                  description: |
                    BIC of the Agent managing the Account which needs to be
                    assessed.
                accountIban:
                  $ref: '#/components/schemas/Iban'
                  description: IBAN identifies the Account which needs to be assessed.
                requestedModels:
                  type: array
                  description: |
                    Array with the types of risks to be assessed, each indicated with *Model Name* and *Model Version*. If no array is provided, all available models will be applied.
                  items:
                    $ref: '#/components/schemas/ModelItem'
              required:
                - accountBic
                - accountIban
            examples:
              OK:
                value:
                  accountName: Mario Rossi
                  accountBic: FPADITMMXXX
                  accountIban: IT02E0300203280782375262458
                  requestedModels:
                    - modelName: Model1
                      modelVersion: '1.0'
                    - modelName: Model2
                      modelVersion: '1.0'
              Bad Request:
                value:
                  accountName: Mario Rossi
                  accountBic: FPADITMMXXX
                  requestedModels:
                    - modelName: Model1
                      modelVersion: '1.0'
                    - modelName: Model2
                      modelVersion: '1.0'
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '201':
          description: Created
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                description: Structure of a FPAD account assessment response.
                properties:
                  fuid:
                    $ref: '#/components/schemas/FpadUniqueIdentifier'
                  accountName:
                    type: string
                    description: |
                      FPAD's higher-ranked Creditor Name associated with the Creditor IBAN. It is only returned when the submitted Creditor Name is not too different from the FPAD higher-ranked Creditor Name (for the correct
                      interpretation of which, please refer to the specific EBA CLEARING reference documentation).
                  riskInfoArray:
                    $ref: '#/components/schemas/RiskInfoArray'
                    description: |
                      RiskInfoArray where each item represents an assessed risk for the Account under evaluation, according to the Participant's request. The item model is identified by the *modelName* and the *modelVersion* properties, while the risk assessment is identified by the *value* property.
                required:
                  - fuid
                  - riskInfoArray
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  value:
                    fuid: beec059e-58bd-40b5-871b-65b3855eb2b0
                    accountName: Mario Rossi
                    riskInfoArray:
                      - modelName: Model1
                        modelVersion: '1.0'
                        modelOutcome: HIGH
                      - modelName: Model2
                        modelVersion: '1.0'
                        modelOutcome: '0.56'
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Field 'accountIban' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  /v1/accounts/assessments/vop:
    post:
      tags:
        - Prevention
      summary: Perform Verification Of Payee (VOP) with Account Assessment
      description: |
        Performs a simultaneous Account Assessment and Verification of Payee request for an account, identified by an IBAN.

        Account Assessment results provide a RiskInfoArray with the outcomes for the models performed as part of the risk assessment. The requestor can define the list of models that will be performed in the risk assessment.  If the models are not defined then a default set of models will be performed, and results returned. 

        Account Assessment results will also provide the Reference Name (Creditor Name) known to FPAD when the party name for the account is present in the request and matches above a defined threshold with the Reference Name known to FPAD.

        As FPAD adapts to changing transactional behaviour, the returned risk assessment may change for different invocations of the API for the same account.

        Verification of Payee (VOP) returns the result of the match between the party name or identification details in the request for the account, identified by the IBAN. Where a name match is performed then in the event of a close match the name of the account holder will be returned.

        FPAD, acting as an RVM, will route the Verification of Payee request to the responding PSP (party agent) directly, if the PSP is using FPAD as RVM, or via the EPC VOP Scheme.
      operationId: create-account-assessment-vop
      parameters:
        - $ref: '#/components/parameters/senderBic'
          description: BIC of the participant sending the request used also as the BIC of the Requesting PSP **(D002)**, unless a Visibility Restriction BIC is present in the user API configuration.
        - $ref: '#/components/parameters/pri'
          description: Participant Request Identifier used also as Requesting PSP’s reference number of the VOP Request **(T054)**.
        - name: X-Request-Timestamp
          description: |
            Timestamp of the VOP Request in ISO 8601 format, either UTC (YYYY-MM-DDThh:mm:ss.sssZ) or local time with UTC offset (YYYY-MM-DDThh:mm:ss.sss+/-hh:mm), milliseconds included.
          in: header
          schema:
            type: string
            format: date-time
          example: '2024-08-12T15:19:21.123Z'
          required: true
      requestBody:
        description: Structure of a FPAD account assessment VOP request.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                accountAssessment:
                  type: object
                  properties:
                    requestedModels:
                      type: array
                      description: |
                        Array with the types of risks to be assessed, each indicated with *Model Name* and *Model Version*. If no array is provided, all available models will be applied.
                      items:
                        $ref: '#/components/schemas/ModelItem'
                vop:
                  type: object
                  properties:
                    party:
                      $ref: '#/components/schemas/PartyType'
                    partyAccount: 
                      $ref: '#/components/schemas/AccountType'
                    partyAgent: 
                      $ref: '#/components/schemas/AgentType'
                    unstructuredRemittanceInformation:
                      description: | 
                        Additional information about AT-C001 sent by the Requester AT-C007, 
                        Usage Rule: only one entry may be used.
                      type: array
                      items:
                        $ref: '#/components/schemas/Max140Text'
                    requestingAgent: 
                      $ref: '#/components/schemas/AgentType'
                  required:
                    - party
                    - partyAccount
                    - partyAgent
                    - requestingAgent
              required:
                - vop
            examples:
              OK:
                value:
                  accountAssessment:
                    requestedModels:
                      - modelName: Model1
                        modelVersion: '1.0'
                      - modelName: Model2
                        modelVersion: '1.0'
                  vop:
                    party:
                      name: John Doe
                    partyAccount:
                      iban: IT76L0300203280825973665778
                    partyAgent:
                      financialInstitutionId:
                        bicfi: BICEXAMPLE1
                    requestingAgent:
                      financialInstitutionId:
                        bicfi: BICEXAMPLE2
              Bad Request:
                value:
                  accountAssessment:
                    requestedModels:
                      - modelName: Model1
                        modelVersion: '1.0'
                      - modelName: Model2
                        modelVersion: '1.0'
                  vop:
                    party:
                      name: John Doe
                    partyAccount:
                      iban: IT76L0300203280825973665778
                    partyAgent:
                      financialInstitutionId:
                        bicfi: BICEXAMPLE1
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '201':
          description: Created
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
            pri:
              $ref: '#/components/headers/pri'
              description: Participant Request Identifier used also as Requesting PSP’s reference number of the VOP Request **(T054)**.
            X-Response-Timestamp:
              schema:
                type: string
                format: date-time
                description: Time stamp of provided by the responding PSP **(T061)**.
              example: '2024-08-12T15:19:22.678Z'
              required: true
          content:
            application/json:
              schema:
                type: object
                description: Structure of a FPAD account assessment response.
                properties:
                  accountAssessment:
                    type: object
                    properties:
                      fuid:
                        $ref: '#/components/schemas/FpadUniqueIdentifier'
                      fpadPayeeName:
                        type: string
                        description: |
                          FPAD's higher-ranked Creditor Name associated with the account IBAN. It is only returned when the submitted Payee Name is not too different from the FPAD higher-ranked Creditor Name (for the correct interpretation of which, please refer to the specific EBA CLEARING reference documentation).
                      riskInfoArray:
                        $ref: '#/components/schemas/RiskInfoArray'
                        description: |
                          RiskInfoArray where each item represents an assessed risk for the Account under evaluation, according to the Participant's request. The item model is identified by the *modelName* and the *modelVersion* properties, while the risk assessment is identified by the *value* property.
                    required:
                      - fuid
                      - riskInfoArray
                  vop:
                    $ref: '#/components/schemas/VerificationOfPayeeResponse'
                  messages:
                    type: array
                    description: |
                      This is an array of messages containing additional information, warnings and errors concerning the results provided in the response.
                    items:
                      $ref: '#/components/schemas/Message'
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                    X-Request-Timestamp: 2024-08-12T15:19:22.678Z
                  value:
                    accountAssessment:
                      fuid: beec059e-58bd-40b5-871b-65b3855eb2b0
                      fpadPayeeName: John Edward Doe
                      riskInfoArray:
                        - modelName: Model1
                          modelVersion: '1.0'
                          modelOutcome: HIGH
                        - modelName: Model2
                          modelVersion: '1.0'
                          modelOutcome: '0.56'
                    vop:
                      partyNameMatch: CMTC
                      matchedName: John Edward Doe
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
            X-Response-Timestamp:
              schema:
                type: string
                format: date-time
              example: '2024-08-12T15:19:22.678Z'
              required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Field 'requestingAgent' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  /v1/accounts/assessments/vop/bulk:
    post:
      tags:
        - Prevention
      summary: Request a Bulk Verification Of Payee (VOP) with Account Assessment
      description: |
        Submits a bulk request for simultaneous Account Assessment and Verification of Payee (VOP) for multiple accounts, identified by their IBANs. This is an asynchronous operation that returns only the *bulkId* and the request status. The execution progress can be monitored calling the corresponding GET endpoint, which also peovides bulk results if the status ia COMPLETED.       
      operationId: create-account-assessment-vop-bulk
      parameters:
        - $ref: '#/components/parameters/senderBic'
          description: BIC of the participant sending the request used also as the BIC of the Requesting PSP **(D002)**, unless a Visibility Restriction BIC is present in the user API configuration.
        - $ref: '#/components/parameters/pri'
        - name: X-Request-Timestamp
          description: |
            Timestamp of the Bulk Request in ISO 8601 format, either UTC (YYYY-MM-DDThh:mm:ss.sssZ) or local time with UTC offset (YYYY-MM-DDThh:mm:ss.sss+/-hh:mm), milliseconds included.
          in: header
          schema:
            type: string
            format: date-time
          example: '2024-08-12T15:19:21.123Z'
          required: true
      requestBody:
        description: Structure of a FPAD account assessment VOP request.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                requestedModels:
                  type: array
                  description: |
                    Array with the types of risks to be assessed, each indicated with *Model Name* and *Model Version*. If no array is provided, all available models will be applied.
                  items:
                    $ref: '#/components/schemas/ModelItem'
                reqs:
                  type: array
                  items:
                    $ref: '#/components/schemas/VopBulkRequest'
              required:
                - reqs
            examples:
              OK:
                value:
                  requestedModels:
                    - modelName: Model1
                      modelVersion: '1.0'
                    - modelName: Model2
                      modelVersion: '1.0'     
                  reqs:
                    - xid: 123e4567-e89b-12d3-a456-426614174000 
                      rBic: REQAGBICXXX 
                      pBic: PTYAGBICXXX 
                      iban: IT60X0542811101000000123456
                      name: Cristopher Sylvester  
              Bad Request:
                value:
                  requestedModels:
                    - modelName: Model1
                      modelVersion: '1.0'
                    - modelName: Model2
                      modelVersion: '1.0'     
                  reqs:
                    - xid: 123e4567-e89b-12d3-a456-426614174000 
                      iban: IT60X0542811101000000123456
                      name: Cristopher Sylvester  
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '201':
          description: Created
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
            pri:
              $ref: '#/components/headers/pri'
              description: Participant Request Identifier used also as Requesting PSP’s reference number of the VOP Request **(T054)**.
          content:
            application/json:
              schema:
                type: object
                description: Structure of a FPAD account assessment response.
                properties:
                  bulkId:
                    type: string
                    format: uuid
                    description: The unique identifier of the bulk request.
                  status:
                    description: | 
                      Specifies the progress status of the bulk request.
                    type: string
                    enum:
                      - PENDING
                      - ERROR 
                required:
                  - bulkId
                  - status
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                    X-Request-Timestamp: 2024-08-12T15:19:22.678Z
                  value:
                    bulkId: beec059e-58bd-40b5-871b-65b3855eb2b0
                    status: PENDING
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Field 'bulkId' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  
  /v1/accounts/assessments/vop/bulk/{bulkId}:
    get:
      tags:
        - Prevention
      summary: Retrieve a Bulk Verification Of Payee (VOP) with Account Assessment
      description: |
        This operation checks the status of and can retrieve the content of a previously requested Bulk Verification Of Payee (VOP) with Account Assessment. It returns a status attribute which provides information about the elaboration process and, if its status is COMPLETED, it also returns bulk results. A HATEOAS block of links, included in the response, provides the URLs needed to get the first/last/previous/next page of records, when results exceed the number that can be returned in a single page.

      operationId: get-account-assessment-vop-bulk
      parameters:
        - name: bulkId
          description: Unique identifier of the bulk request.
          in: path
          schema:
            type: string
            format: uuid
          required: true
        - $ref: '#/components/parameters/senderBic'
          description: BIC of the participant sending the request used also as the BIC of the Requesting PSP **(D002)**, unless a Visibility Restriction BIC is present in the user API configuration.
        - $ref: '#/components/parameters/pri'
        - name: page
          in: query
          schema:
            type: integer
          description: |
            Report page number requested.
            If this page does not exist, an error will be returned.
            If this parameter is not provided, the first page will be returned.
        - name: itemsPerPage
          in: query
          schema:
            type: integer
          description: |
            Number of items per page requested.
            If this number exeeds the maximum allowed by the system configuration, an error will be returned.
            If this parameter is not provided, the maximum allowed number of items per pages will be applied.
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
            x-sandbox-request-path-params:
              bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
        '401':
          Unauthorized:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b401
            x-sandbox-request-path-params:
              bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
        '403':
          Forbidden:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29a403
            x-sandbox-request-path-params:
              bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
          Forbidden (application managed):
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b403
            x-sandbox-request-path-params:
              bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
        '404':
          Not Found:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b404
            x-sandbox-request-path-params:
              bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
        '409':
          Conflict:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b409
            x-sandbox-request-path-params:
              bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
        '429':
          Too many requests:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b429
            x-sandbox-request-path-params:
              bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
        '500':
          Generic Error:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29a500
            x-sandbox-request-path-params:
              bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
          Generic Error (application managed):
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b500
            x-sandbox-request-path-params:
              bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
      responses:
        '200':
          description: OK
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                properties:
                  bulkId:
                    description: Unique identifier of the bulk request.
                    type: string
                    format: uuid
                  status:
                    description: | 
                      Specifies the progress status of the bulk request.
                    type: string
                    enum:
                      - PENDING
                      - COMPLETED
                      - ERROR
                  counters:
                    description: Set of counters for VOP responses by match result. All counters are related to the whole bulk set, not to the single page retrieved. 
                    type: array
                    items:
                      $ref: '#/components/schemas/VopBulkResponseCounter'
                  outcome:
                    type: array
                    items:
                      oneOf:
                        - $ref: '#/components/schemas/VopBulkResponse'
                        - $ref: '#/components/schemas/ShortErrorResponse'
                  pagination:
                    description: |
                      This field contains the number, the page and link of pagination response
                    $ref: '#/components/schemas/PaginationInfo'
                required:
                  - bulkId
                  - status
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                    X-Request-Timestamp: 2024-08-12T15:19:22.678Z
                  x-sandbox-request-path-params:
                    bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
                  value:
                    bulkId: 4ac04478-d70d-4d25-8bde-f2ad0001093d
                    status: COMPLETED
                    counters:
                      - matchingResult: CMTC
                        counter: 1
                    outcome:
                      - xid: 27587f4f-0a5b-459b-93f6-e87de1e8496d
                        fuid: 4ac04478-d70d-4d25-8bde-f2ad0001093d
                        fName: John Alexander Doe
                        ria:
                          - name: R_ReferenceNameMatch
                            ver: 1.00
                            out: 0
                            narr: RNMANK
                        vPnm: CMTC
                        vName: John Alexander Doe
                        vrts: 2024-08-12T15:19:22.678Z
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Field 'status' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '404':
          description: Not Found
          $ref: '#/components/responses/ErrorResponse_404'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'  
  /vop/v1/payee-verifications:
    post:
      tags:
        - Prevention
      summary: Perform Verification Of Payee (VOP)
      operationId: postVerificationOfPayeeRequests
      description: |
        Performs a Verification of Payee (VOP) only request and 
        returns the result of the match between the party name or identification details in the request for the account, identified by the IBAN. Where a name match is performed then in the event of a close match the name of the account holder will be returned.

        FPAD, acting as an RVM, will route the Verification of Payee request to the responding PSP (party agent) directly, if the PSP is using FPAD as RVM, or via the EPC VOP Scheme.
      parameters:
      - name: X-Request-ID
        description: The Requesting PSP's reference number of the VOP Request
        in: header
        schema:
          type: string
          format: uuid
        required: true
      - name: X-Request-Timestamp
        description: |
          Timestamp of the VOP Request in ISO 8601 format, either UTC (YYYY-MM-DDThh:mm:ss.sssZ) or local time with UTC offset (YYYY-MM-DDThh:mm:ss.sss+/-hh:mm), milliseconds included.
        in: header
        schema:
          type: string
          format: date-time
        example: '2024-08-12T15:19:21.123Z'
        required: true
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VerificationOfPayeeRequest'
            examples:
              OK:
                value:
                  party:
                    name: John Doe
                  partyAccount:
                    iban: IT76L0300203280825973665778
                  partyAgent:
                    financialInstitutionId:
                      bicfi: BICEXAMPLE1
                  requestingAgent:
                    financialInstitutionId:
                      bicfi: BICEXAMPLE2
              Bad Request:
                value:
                  party:
                    name: John Doe
                  partyAccount:
                    iban: IT76L0300203280825973665778
                  partyAgent:
                    financialInstitutionId:
                      bicfi: BICEXAMPLE1
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['X-Request-ID'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              X-Request-ID: a206e009-ef37-4040-924d-db758b29b400
              X-Request-Timestamp: 2024-08-12T15:19:22.678Z
            x-sandbox-response-body: |
              {
              <#if validationErrors??>
                <#list validationErrors as error>
                "type": "For future use", 
                "code":"FORMAT_ERROR",
                "title": "Bad Request",
                "status": 400,
                "detail": "${error.message}",
                "instance": "https://fpad.ebaclearing.eu/vop/v1/payee-verifications"
                </#list>
              <#else>
                "type": "For future use", 
                "code":"FORMAT_ERROR",
                "title": "Error",
                "status": 400,
                "detail": "Type mismatch",
                "instance": "https://fpad.ebaclearing.eu/vop/v1/payee-verifications"
              </#if>
              }
        '401':
          Client invalid. The Requesting PSP is not correctly authorized to perform the request.:
            x-sandbox-request-headers:
              X-Request-ID: a206e009-ef37-4040-924d-db758b29b401
              X-Request-Timestamp: 2024-08-12T15:19:22.678Z
        '500':
          Internal Server Error. This code is used whenever a technical problem occurred in the application code or application server that prevented the execution of the request.:
            x-sandbox-request-headers:
              X-Request-ID: a206e009-ef37-4040-924d-db758b29b500
              X-Request-Timestamp: 2024-08-12T15:19:22.678Z
      responses:
        '200':
          description: A verification code and the actual name if the code is CMTC
          headers:
            X-Request-ID:
              schema:
                type: string
                format: uuid
              example: 'a206e009-ef37-4040-924d-db758b29b200'
              required: true
            X-Response-Timestamp:
              schema:
                type: string
                format: date-time
              example: '2024-08-12T15:19:22.678Z'
              required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationOfPayeeResponse'
              examples:
                OK:
                  x-sandbox-request-headers:
                    X-Request-ID: a206e009-ef37-4040-924d-db758b29b200
                    X-Request-Timestamp: 2024-08-12T15:19:22.678Z
                  value:
                    partyNameMatch: CMTC
                    matchedName: John Edward Doe
        '400':
          description: Malformed payload
          headers:
            X-Request-ID:
              schema:
                type: string
                format: uuid
              required: true
            X-Response-Timestamp:
              schema:
                type: string
                format: date-time
              example: '2024-08-12T15:19:22.678Z'
              required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationOfPayeeError'
              examples:
                Bad Request:
                  x-sandbox-request-headers:
                    X-Request-ID: a206e009-ef37-4040-924d-db758b29b400
                    X-Request-Timestamp: 2024-08-12T15:19:22.678Z
                  value:
                    type: ERROR
                    code: FORMAT_ERROR
                    title: Bad Rquest
                    status: 400
                    detail: The payload is malformed.
                    instance: https://fpad.ebaclearing.eu/vop/v1/payee-verifications
        '401':
          description: Client invalid. The Requesting PSP is not correctly authorized to perform the request.  
          headers:
            X-Request-ID:
              schema:
                type: string
                format: uuid
              required: true
            X-Response-Timestamp:
              schema:
                type: string
                format: date-time
              example: '2024-08-12T15:19:22.678Z'
              required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationOfPayeeError'
              examples:
                Unauthorized:
                  x-sandbox-request-headers:
                    X-Request-ID: a206e009-ef37-4040-924d-db758b29b401
                    X-Request-Timestamp: 2024-08-12T15:19:22.678Z
                  value:
                    type: ERROR
                    code: CLIENT_INVALID
                    title: Unauthorized
                    status: 400
                    detail: The client is not authenticated or authorized.
                    instance: https://fpad.ebaclearing.eu/vop/v1/payee-verifications
        '500':
          description: Internal Server Error. This code is used whenever a technical problem occurred in the application code or application server that prevented the execution of the request.
          headers:
            X-Request-ID:
              schema:
                type: string
                format: uuid
              required: true
            X-Response-Timestamp:
              schema:
                type: string
                format: date-time
              example: '2024-08-12T15:19:22.678Z'
              required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VerificationOfPayeeError'
              examples:
                Generic Error:
                  x-sandbox-request-headers:
                    X-Request-ID: a206e009-ef37-4040-924d-db758b29b500
                    X-Request-Timestamp: 2024-08-12T15:19:22.678Z
                  value:
                    type: ERROR
                    code: CLIENT_INCONSISTENT
                    title: Internal Server error
                    status: 500
                    detail: An error occurred while executing the service.
                    instance: https://fpad.ebaclearing.eu/vop/v1/payee-verifications
  /v1/transactions/assessments:
    post:
      tags:
        - Prevention
      summary: Create Transaction Assessment
      description: |
        This operation creates a pre-validation risk assessment for a
        transaction before it is sent for clearing and settlement.
        
        It returns the results of the risk assessment in a *RiskInfoArray* that provides the outcomes for all the models performed as part of the risk assessment. The requestor can define the list of models that will be performed in the risk assessment. If the models are not defined then a default set of models will be performed, and results returned.

        As FPAD adapts to changing transactional behaviour, the returned risk assessment may change for different invocations of the API for the same account.
      operationId: create-transaction-assessment
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
      requestBody:
        description: Structure of a FPAD transaction assessment request.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                transactionData:
                  $ref: '#/components/schemas/AssessmentTransactionData'
                  description: Data of the Potential transaction to be assessed.
                requestedModels:
                  type: array
                  description: |
                    Array with the types of risks to be assessed, each indicated with *Model Name* and *Model Version*. If no array is provided, all available models will be applied.
                  items:
                    $ref: '#/components/schemas/ModelItem'
              required:
                - transactionData
            examples:
              OK:
                value:
                  transactionData:
                    serviceType: SCTInst
                    transactionId: 41e400e45
                    debtorName: Mario Rossi
                    debtorBic: FPADITMMXXX
                    debtorIban: IT02E0300203280782375262458
                    creditorName: Eric Mulder
                    creditorBic: FPFPDEMM441
                    creditorIban: DE89370400440532013000
                    amount: 1000
                    currency: EUR
                    referenceDateTime: '2023-03-23T14:15:22Z'
                    categoryPurpose: ABCD
                    purposeCode: ABCD
                  requestedModels:
                    - modelName: Model1
                      modelVersion: '1.0'
                    - modelName: Model5
                      modelVersion: '1.1'
              Bad Request:
               value:
                  requestedModels:
                    - modelName: Model1
                      modelVersion: '1.0'
                    - modelName: Model5
                      modelVersion: '1.1'
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '201':
          description: Created
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                description: Structure of a FPAD transaction assessment response body.
                properties:
                  fuid:
                    $ref: '#/components/schemas/FpadUniqueIdentifier'
                  riskInfoArray:
                    $ref: '#/components/schemas/RiskInfoArray'
                    description: |
                      RiskInfoArray where each item represents an assessed risk for **transaction**, according to the Participant's request. The item model is identified by the *modelName* and the *modelVersion* properties, while the risk assessment is identified by the *value* property.
                required:
                  - fuid
                  - riskInfoArray
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  value:
                    fuid: beec059e-58bd-40b5-871b-65b3855eb2b0
                    riskInfoArray:
                      - modelName: Model1
                        modelVersion: '1.0'
                        modelOutcome: HIGH
                      - modelName: Model2
                        modelVersion: '1.0'
                        modelOutcome: '0.99'
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Field 'transactionData' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'  
  /v1/transactions/investigations:
    get:
      tags:
        - Detection
      summary: Retrieve Transaction Investigation by Transaction Key
      description: |
        This operation retrieves a risk assessment for a single pacs.008 SCT or SCT Inst transaction that has been completed in STEP2-T or RT1. It returns a *RiskInfoArray* that provides the outcomes for the models performed at the time that the transaction was received by FPAD.
        
        The returned result is a static, historical risk assessment that will remain the same across multiple calls for the same transaction. The returned *RiskInfoArray* will contain all models performed at the time of the original risk assessment. The models cannot be selected as part of the call.

        The *RiskInfoArray* is retrieved through the transaction key elements:
        service Type, debtor agent BIC, transaction ID, reference date.

        If no transaction matching input data is found, an empty body is returned.
      operationId: get-transaction-investigation-by-transaction-key
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
        - schema:
            $ref: '#/components/schemas/ServiceType'
          in: query
          name: serviceType
          description: 'EBA CLEARING Service Type (SCT, SCTInst).'
          required: true
        - schema:
            $ref: '#/components/schemas/Bic'
          in: query
          name: debtorBic
          description: BIC of the Debtor's Agent.
          required: true
        - schema:
            type: string
            maxLength: 35
          in: query
          name: transactionId
          description: 'Identifier of the transaction, unique for the Debtor''s Agent.'
          required: true
        - schema:
            type: string
            format: date-time
          in: query
          name: referenceDateTime
          description: |
            It must match with settlementDate for SCT and acceptanceDateTime for SCTInst services.
          required: true
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-request-query-params:
              debtorBic: FPADITMMXXX
              transactionId: 41e400e45
              referenceDateTime: 2023-03-23T14:15:22Z
            x-sandbox-request-name: OK
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '200':
          description: OK
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                title: GetTransactionInvestigationResponse
                description: Structure of a FPAD transaction investigation response.
                properties:
                  fuid:
                    $ref: '#/components/schemas/FpadUniqueIdentifier'
                    description: |
                      FPAD Unique Identifier of the transaction investigation found.
                  transactionData:
                    $ref: '#/components/schemas/InvestigationTransactionData'
                    description: Basic elements of the transaction.
                  riskInfoArray:
                    $ref: '#/components/schemas/RiskInfoArray'
                    description: RiskInfoArray for the transaction.
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  x-sandbox-request-query-params:
                    serviceType: SCT
                    debtorBic: FPADITMMXXX
                    transactionId: 41e400e45
                    referenceDateTime: 2023-03-23T14:15:22Z
                  value:
                    fuid: 4ac04478-d70d-4d25-8bde-f2ad0001093d
                    transactionData:
                      instructingAgentBic: FPADITMM
                      instructedAgentBic: FPADITMM
                      serviceType: SCTInst
                      transactionId: 41e400e45
                      debtorName: Mario Rossi
                      debtorBic: FPADITMMXXX
                      debtorIban: IT02E0300203280782375262458
                      creditorName: Eric Mulder
                      creditorBic: FPFPDEMM441
                      creditorIban: DE89370400440532013000
                      amount: 1000
                      currency: EUR
                      referenceDateTime: '2023-03-23T14:15:22Z'
                      categoryPurpose: ABCD
                      purposeCode: ABCD
                    riskInfoArray:
                      - modelName: Model1
                        modelVersion: '1.0'
                        modelOutcome: HIGH
                      - modelName: Model2
                        modelVersion: '1.0'
                        modelOutcome: '0.99'
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Parameter 'serviceType' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  '/v1/transactions/investigations/{fuid}':
    get:
      summary: Retrieve Transaction Investigation By FUID
      description: |
        This operation retrieves a risk assessment for a single pacs.008 SCT or SCT Inst transaction that has been completed in STEP2-T or RT1. It returns a *RiskInfoArray* that provides the outcomes for the models performed at the time that the transaction was received by FPAD.
        
        The returned result is a static, historical risk assessment that will remain the same across multiple calls for the same transaction. The returned *RiskInfoArray* will contain all models performed at the time of the original risk assessment. The models cannot be selected as part of the call. 

        The *RiskInfoArray* is retrieved through the FUID assigned to the
        *RiskInfoArray* during transaction data collection.

        If *fuid* is not found, a 404 error is returned.
      operationId: get-transaction-investigation-by-fuid
      parameters:
        - $ref: '#/components/parameters/fuid'
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-request-path-params:
              "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-name: OK
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
        '401':
          Unauthorized:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b401
            x-sandbox-request-path-params:
              "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-name: OK
        '403':
          Forbidden:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a403
            x-sandbox-request-path-params:
              "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-name: OK
          Forbidden (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b403
            x-sandbox-request-path-params:
              "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-name: OK
        '404':
          Not Found:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b404
            x-sandbox-request-path-params:
              "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-name: OK
        '409':
          Conflict:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b409
            x-sandbox-request-path-params:
              "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-name: OK
        '429':
          Too many requests:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b429
            x-sandbox-request-path-params:
              "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-name: OK
        '500':
          Generic Error:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a500
            x-sandbox-request-path-params:
              "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-name: OK
          Generic Error (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b500
            x-sandbox-request-path-params:
              "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-name: OK
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                title: GetTransactionInvestigationResponse
                description: Structure of a FPAD transaction investigation response.
                properties:
                  fuid:
                    $ref: '#/components/schemas/FpadUniqueIdentifier'
                    description: |
                      FPAD Unique Identifier of the transaction investigation found.
                  transactionData:
                    $ref: '#/components/schemas/InvestigationTransactionData'
                    description: Basic elements of the transaction.
                  riskInfoArray:
                    $ref: '#/components/schemas/RiskInfoArray'
                    description: RiskInfoArray for the transaction.
              examples:
                OK:
                  x-sandbox-request-path-params:
                    "fuid": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  value:
                    fuid: 4ac04478-d70d-4d25-8bde-f2ad0001093d
                    transactionData:
                      instructingAgentBic: FPADITMM
                      instructedAgentBic: FPADITMM
                      serviceType: SCTInst
                      transactionId: 41e400e45
                      debtorName: Mario Rossi
                      debtorBic: FPADITMMXXX
                      debtorIban: IT02E0300203280782375262458
                      creditorName: Eric Mulder
                      creditorBic: FPFPDEMM441
                      creditorIban: DE89370400440532013000
                      amount: 1000
                      currency: EUR
                      referenceDateTime: '2023-03-23T14:15:22Z'
                      categoryPurpose: ABCD
                      purposeCode: ABCD
                    riskInfoArray:
                      - modelName: Model1
                        modelVersion: '1.0'
                        modelOutcome: HIGH
                      - modelName: Model2
                        modelVersion: '1.0'
                        modelOutcome: '0.99'
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Parameter 'senderBic' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '404':
          description: Not Found
          $ref: '#/components/responses/ErrorResponse_404'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
      tags:
        - Detection
  /v1/transactions/investigations/reports:
    post:
      tags:
        - Detection
      summary: Request Transaction Investigation Report
      description: |
        This operation requests creation of a report that provides the risk
        assessments for multiple pacs.008 SCT or SCT Inst transactions that have been completed in STEP2-T or RT1. It returns a reportId that is then used by the Retrieve Transaction Investigation Report operation to retrieve the request status and and its outcome.

        The request allows several *transactionFilter* parameters to be defined that allow a set of transactions to be selected in the report.
      operationId: create-transaction-investigation-report
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
      requestBody:
        description: Structure of a FPAD transaction report request.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                reportName:
                  type: string
                  description: A name for the requested report assigned by the caller.
                transactionFilter:
                  $ref: '#/components/schemas/TransactionInvestigationReportFilter'
                  description: |
                    Data of the Potential transaction to be assessed. The
                    following rules apply:

                    - In general, each type of information is applied in AND
                    with respect to the others.

                    - A BIC can contain only 8 or 11 characters.

                    - The TransactionID and an IBAN are compared for exact
                    equality only.

                    - The Name is treated as a prefix for a wildcard match.
                    There are also limits to the possible combinations and uses
                    of the function (e.g., the maximum number of occurrences
                    envisaged for a Report, the maximum size of a Report, etc.).

                    For the complete list of these limitations, refer to the
                    specific FPAD documentation for the API.
              required:
                - transactionFilter
            examples:
              OK:
                value:
                  transactionFilter:
                    instructingAgentBic: FPADITMM
                    serviceType: SCT
                    debtorIban: IT78K0300203280111271851199
                    minAmount: 1000
                    currency: EUR
                    minReferenceDateTime: '2023-05-01T00:00:00Z'
                    maxReferenceDateTime: '2023-05-02T23:59:59Z'
              Bad Request:
                value:
                  reportName: Test
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '202':
          description: Accepted
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                description: Response of a Request Transaction Investigation Report.
                properties:
                  reportId:
                    type: string
                    format: uuid
                    description: Unique identifier for the requested report.
                required:
                  - reportId
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  value:
                    reportId: 9afffb1a-f8bb-4345-bda4-f6e97d50cba8
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Field 'transactionFilter' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
    parameters: []
  '/v1/transactions/investigations/reports/{reportId}':
    get:
      tags:
        - Detection
      summary: Retrieve Transaction Investigation Report
      description: |
        This operation checks the status of and can retrieve the content of a previously requested Transaction Investigation Report. It returns a status attribute which provides information about the elaboration process and, if its status is COMPLETED, it also returns the report outcome. A HATEOAS block of links, included in the response, provides the URLs needed to get the first/last/previous/next page of records, when transactions exceed the number that can be returned in a single page.

        Report pages provide references to the transactions and the associated *RiskInfoArray* providing the result of the risk assessment performed at the time the that the transaction was received by FPAD. The returned *RiskInfoArray* will contain all models performed at the time of the original risk assessment.
      operationId: get-transaction-investigation-report
      parameters:
        - schema:
            type: string
            format: uuid
          name: reportId
          in: path
          required: true
          description: Unique identifier for a requested report.
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
        - schema:
            type: integer
          in: query
          name: page
          description: |
            Report page number requested.
            
            If this page does not exist, an error will be returned.
            
            If this parameter is not provided, the first page will be returned.
        - schema:
            type: integer
          in: query
          name: itemsPerPage
          description: |
            Number of items per page requested.
            
            If this number exeeds the maximum allowed by the system configuration, an error will be returned.
            
            If this parameter is not provided, the maximum allowed number of items per pages will be applied.
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
        '401':
          Unauthorized:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b401
            x-sandbox-request-path-params:
              "reportId": "7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c"
        '403':
          Forbidden:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a403
            x-sandbox-request-path-params:
              "reportId": "7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c"
          Forbidden (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b403
            x-sandbox-request-path-params:
              "reportId": "7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c"
        '404':
          Not Found:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b404
            x-sandbox-request-path-params:
              "reportId": "7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c"
        '409':
          Conflict:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b409
            x-sandbox-request-path-params:
              "reportId": "7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c"
        '429':
          Too many requests:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b429
            x-sandbox-request-path-params:
              "reportId": "7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c"
        '500':
          Generic Error:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a500
            x-sandbox-request-path-params:
              "reportId": "7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c"
          Generic Error (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b500
            x-sandbox-request-path-params:
              "reportId": "7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c"
      responses:
        '200':
          description: OK
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                description: Response of a Get Transaction Investigtion Report.
                properties:
                  reportId:
                    type: string
                    format: uuid
                    description: Unique identifier for the requested report.
                  reportRequestDateTime:
                    type: string
                    format: date-time
                    description: Date and time of the report request.
                  reportProcessingDateTime:
                    type: string
                    format: date-time
                    description: |
                      Date and time at which the report request has been
                      processed.
                  status:
                    type: string
                    enum:
                      - REQUESTED
                      - COMPLETED
                      - ERROR
                  outcome:
                    type: array
                    description: |
                      This object contains the report outcome. It is present obly if the report status is COMPLETED.
                    items:
                      type: object
                      properties:
                        fuid:
                          $ref: '#/components/schemas/FpadUniqueIdentifier'
                          description: |
                            FPAD Unique Identifier of the evaluated
                            RiskInfoArray for the transaction.
                        transactionKey:
                          $ref: '#/components/schemas/TransactionKey'
                        debtorIban:
                          $ref: '#/components/schemas/Iban'
                          description: IBAN of the debtor's account.
                        creditorBic:
                          $ref: '#/components/schemas/Bic'
                          description: |
                            BIC of the Agent managing the Creditor's Account.
                        creditorIban:
                          $ref: '#/components/schemas/Iban'
                          description: |
                            IBAN of the creditor's account.
                        amount:
                          $ref: '#/components/schemas/Amount'
                          description: Amount of the transaction.
                        currency:
                          $ref: '#/components/schemas/Currency'
                          description: |
                            Currency of the transaction amount.
                        riskInfoArray:
                          $ref: '#/components/schemas/RiskInfoArray'
                          description: RiskInfoArray for the transaction.
                      required:
                        - fuid
                        - transactionKey
                        - riskInfoArray
                  messages:
                    type: array
                    description: |
                      This is an array of messages containing warnings and
                      errors encountered during the report generation process.
                    items:
                      $ref: '#/components/schemas/Message'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'
                required:
                  - reportId
                  - reportRequestDateTime
                  - status
              examples:
                OK:
                  x-sandbox-request-path-params:
                    reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  value:
                    reportId: 836df459-dc40-4aa1-972a-6eb0a864dff9
                    reportRequestDateTime: '2019-08-24T14:15:22Z'
                    reportProcessingDateTime: '2019-08-24T14:15:22Z'
                    status: COMPLETED
                    outcome:
                      - fuid: beec059e-58bd-40b5-871b-65b3855eb2b0
                        transactionKey:
                          serviceType: SCT
                          debtorBic: FPADITMMXXX
                          transactionId: 41e400e45
                          referenceDateTime: '2019-08-24T14:15:22Z'
                        debtorIban: IT02E0300203280782375262458
                        creditorIban: DE89370400440532013000
                        amount: 1000
                        currency: EUR
                        riskInfoArray:
                          - modelName: Model1
                            modelVersion: '1.0'
                            modelOutcome: HIGH
                          - modelName: Model2
                            modelVersion: '1.0'
                            modelOutcome: '0.56'
                    pagination:
                      currentPage: 1
                      totalPages: 1
                      itemsPerPage: 100
                      links:
                        - rel: self
                          href: |
                            /transactions/investigations/reports/fc91e31c-820f-4a9e-94ba-371cb2dcaa1d?page=1
                        - rel: next
                          href: |
                            /transactions/investigations/reports/fc91e31c-820f-4a9e-94ba-371cb2dcaa1d?page=2
                        - rel: first
                          href: |
                            /transactions/investigations/reports/fc91e31c-820f-4a9e-94ba-371cb2dcaa1d?page=1
                        - rel: last
                          href: |
                            /transactions/investigations/reports/fc91e31c-820f-4a9e-94ba-371cb2dcaa1d?page=15
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Parameter 'senderBic' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '404':
          description: Not Found
          $ref: '#/components/responses/ErrorResponse_404'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  /v1/accounts/investigations/mule/reports:
    post:
      tags:
        - Detection
      summary: Request Mule Account Investigation Report
      description: |
        This operation can be used to request the creation of a Mule Account Investigation Report for:
          - a specific IBAN of the Participant;
          - a specific IBAN of a Participant's RB/APSP;
          - all IBANs of the Participant;
          - all IBANs of a specific Participant's RB/APSP branch;
          - all IBANs of all branches of Particpant's RBs/APSPs which share the same BIC8; 
          - all IBANs of all branches of both the Participant's and all its RBs/APSPs.

          The report will be homogeneous according to the chosen account role (REPORTED, LINKED).
        
        It returns a *reportId* that can be used with the Retrieve Mule Account Investigation Report operation to retrieve the request status and its outcome.
      operationId: create-accounts-investigations-mule-report
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                reportName:
                  type: string
                  description: A name for the requested report assigned by the caller.
                muleAccountInvestigationFilter:
                  $ref: '#/components/schemas/MuleAccountInvestigationReportFilter'
                  description: Filter used for exctractng mule account investigation reports.
              required:
                - muleAccountInvestigationFilter
            examples:
              OK:
                value:
                  muleAccountInvestigationFilter:
                    accountRole: REPORTED
                    accountBic: FPADITMMXXX
                    caseDateFrom: 2025-10-10
                    caseDateTo: 2025-10-15
              Bad Request:
                value:
                  reportName: Test
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '202':
          description: Accepted
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                description: Response of a Request Mule Account Investigation Report.
                properties:
                  reportId:
                    type: string
                    format: uuid
                    description: Unique identifier for the requested report.
                required:
                  - reportId
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  value:
                    reportId: 9afffb1a-f8bb-4345-bda4-f6e97d50cba8
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Field 'muleAccountInvestigationFilter' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
    parameters: []
  '/v1/accounts/investigations/mule/reports/{reportId}':
    get:
      tags:
        - Detection
      summary: Retrieve Mule Account Investigation Report
      description: |
        This operation checks the status of and can retrieve the content of a previously requested Mule Account Investigation Report. It returns a status attribute which provides information about the elaboration process and, if its status is COMPLETED, it also returns the report outcome. A HATEOAS block of links, included in the response, provides the URLs needed to get the first/last/previous/next page of records, when transactions exceed the number that can be returned in a single page.

        Report pages provide references to the account and the correspondent calculated *RiskInfoArray*.
      operationId: get-acccount-investigations-mule-report
      parameters:
        - schema:
            type: string
            format: uuid
          name: reportId
          in: path
          required: true
          description: Unique identifier for a requested report.
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
        - schema:
            type: integer
          in: query
          name: page
          description: |
            Report page number requested.
            
            If this page does not exist, an error will be returned.
            
            If this parameter is not provided, the first page will be returned.
        - schema:
            type: integer
          in: query
          name: itemsPerPage
          description: |
            Number of items per page requested.
            
            If this number exeeds the maximum allowed by the system configuration, an error will be returned.
            
            If this parameter is not provided, the maximum allowed number of items per pages will be applied.
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
        '401':
          Unauthorized:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b401
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
        '403':
          Forbidden:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a403
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
          Forbidden (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b403
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
        '404':
          Not Found:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b404
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
        '409':
          Conflict:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b409
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
        '429':
          Too many requests:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b429
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
        '500':
          Generic Error:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a500
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
          Generic Error (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b500
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
      responses:
        '200':
          description: OK
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                description: Response of a Get Mule Account Investigation Report.
                properties:
                  reportId:
                    type: string
                    format: uuid
                    description: Unique identifier for the requested report.
                  reportRequestDateTime:
                    type: string
                    format: date-time
                    description: Date and time of the report request.
                  reportProcessingDateTime:
                    type: string
                    format: date-time
                    description: |
                      Date and time at which the report request has been
                      processed.
                  status:
                    type: string
                    enum:
                      - REQUESTED
                      - COMPLETED
                      - ERROR
                  outcome:
                    type: array
                    description: |
                      This object contains the report outcome. It is present obly if the report status is COMPLETED.
                    items:
                      type: object
                      properties:
                        fuid:
                          $ref: '#/components/schemas/FpadUniqueIdentifier'
                          description: |
                            FPAD Unique Identifier of the evaluated
                            RiskInfoArray for the account.
                        accountRole:
                          $ref: '#/components/schemas/MuleAccountRole'
                        accountIban:
                          $ref: '#/components/schemas/Iban'
                          description: IBAN of the account.
                        caseDate:
                          description: Triggering date of the mule account analysis case.
                          type: string
                          format: date
                        muleRiskInfoArray:
                          $ref: '#/components/schemas/RiskInfoArray'
                          description: RiskInfoArray for the mule account.
                      required:
                        - fuid
                        - accountRole
                        - accountIban
                        - caseDate
                        - muleRiskInfoArray
                  messages:
                    type: array
                    description: |
                      This is an array of messages containing warnings and
                      errors encountered during the report generation process.
                    items:
                      $ref: '#/components/schemas/Message'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'
                required:
                  - reportId
                  - reportRequestDateTime
                  - status
              examples:
                OK:
                  x-sandbox-request-path-params:
                    reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  value:
                    reportId: 836df459-dc40-4aa1-972a-6eb0a864dff9
                    reportRequestDateTime: '2019-08-24T14:15:22Z'
                    reportProcessingDateTime: '2019-08-24T14:15:22Z'
                    status: COMPLETED
                    outcome:
                      - fuid: beec059e-58bd-40b5-871b-65b3855eb2b0
                        accountRole: REPORTED
                        accountIban: IT02E0300203280782375262458
                        caseDate: 2025-10-15
                        muleRiskInfoArray:
                          - modelName: Model1
                            modelVersion: '1.0'
                            modelOutcome: HIGH
                          - modelName: Model2
                            modelVersion: '1.0'
                            modelOutcome: '0.56'
                    pagination:
                      currentPage: 1
                      totalPages: 1
                      itemsPerPage: 100
                      links:
                        - rel: self
                          href: |
                            /transactions/investigations/reports/fc91e31c-820f-4a9e-94ba-371cb2dcaa1d?page=1
                        - rel: next
                          href: |
                            /transactions/investigations/reports/fc91e31c-820f-4a9e-94ba-371cb2dcaa1d?page=2
                        - rel: first
                          href: |
                            /transactions/investigations/reports/fc91e31c-820f-4a9e-94ba-371cb2dcaa1d?page=1
                        - rel: last
                          href: |
                            /transactions/investigations/reports/fc91e31c-820f-4a9e-94ba-371cb2dcaa1d?page=15
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Parameter 'senderBic' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '404':
          description: Not Found
          $ref: '#/components/responses/ErrorResponse_404'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  /v1/risk-info/feedbacks:
    post:
      tags:
        - Feedback
      summary: Provide Feedback
      description: >
        This operation allows feedback to be provided against the results of an FPAD risk assessment identified by an FPAD Unique ID (FUID). The same API is used to provide feedback on Account Assessment, Mule Account Assessment, Transaction Assessment and Transaction Investigation risk assessments. The feedback should reflect the outcome of the risk assessment as determined by the PSP.

        The API can be called multiple times for any FUID allowing the PSP to change the feedback provided to FPAD.
      operationId: create-feedback-by-fuid
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Structure of a FPAD assessment feedback request.
              properties:
                feedbackType:
                  type: string
                  enum:
                    - TRXASS
                    - ACCASS
                    - TRXINV
                    - MULINV
                  description: |
                    Feedback type:

                    - TRXASS: Prevention - Transaction assessment

                    - ACCASS: Prevention - Account assessment

                    - TRXINV: Detection - Transaction investigation (settled transactions evaluated during the data collecting phase)

                    - MULINV: Detection - Mule Account investigation
                fuid:
                  $ref: '#/components/schemas/FpadUniqueIdentifier'
                  description: |
                    FPAD Unique Identifier of the risk info evaluation for which the feedback is provided.
                feedbackValue:
                  type: string
                  description: |
                    Feedback value provided for the risk info evaluation
                    identified by its FUID. The Feedback Value fields decode to the following:

                    - HIGHRISK – The risk assessment referenced by the FUID is considered high risk.

                    - LOWRISK – The risk assessment referenced by the FUID is considered low risk.

                    - NOFEEDBACK – It was not possible to determine a risk
                    outcome for the risk assessment referenced by the FUID.

                    - IGNORE – The risk outcome, and any previously submitted risk outcomes, for the risk assessment referenced by the FUID should be ignored.
                  enum:
                    - HIGHRISK
                    - LOWRISK
                    - NOFEEDBACK
                    - IGNORE
              required:
                - feedbackType
                - fuid
                - feedbackValue
            examples:
              OK:
                value:
                  feedbackType: TRXASS
                  fuid: 4ac04478-d70d-4d25-8bde-f2ad0009999d
                  feedbackValue: LOWRISK
              Bad Request:
                value:
                  feedbackType: NOTYPE
                  fuid: 4ac04478-d70d-4d25-8bde-f2ad0009999d
                  feedbackValue: LOWRISK
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '201':
          description: Created
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  value: ''
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Value 'NOTYPE' is not defined in the schema.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  /v1/insight-notifications/accounts:
    post:
      tags:
        - Insight Notifications
      summary: Submit an Account Insight Notification
      description: >
        This operation allows a PSP to provide an Account Insight Notification.If the PSP sumbits an Insight with an insight ID which is already stored in FPAD, the submitted insight will replace the existing one.
      operationId: submit-account-insight-notification
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InsightAccountCore'
            examples:
              Created:
                value:
                  insightContext:
                    insightId: b62f6d3a-7a01-4d62-81ce-b3ea8cf1b1f0
                    caseId: df27a84e-709d-4d56-a82b-2ad1000ed33d
                    identificationDate: 2025-08-10
                    fuidRef: ac04ab78-d704-4d56-b82b-2ad0000ed33d
                    detectedByFpad: true
                  accountData:
                    accountBic: FPADITMMXXX
                    accountIban: IT70X0300203280112771851190
                    accountName: Mario Rossi
                    accountType: Personal
                  ebaFraudTaxonomy:
                    initiator: customer
                    method: phishing
                    modus: social engineering
                    labels:
                      - label1
                      - label2
              Replaced:
                value:
                  insightContext:
                    insightId: b62f6d3a-7a01-4d62-81ce-b3ea8cf1b1f0
                    caseId: df27a84e-709d-4d56-a82b-2ad1000ed33d
                    identificationDate: 2025-08-10
                    fuidRef: ac04ab78-d704-4d56-b82b-2ad0000ed33d
                    detectedByFpad: true
                  accountData:
                    accountBic: FPADITMMXXX
                    accountIban: IT70X0300203280112771851190
                    accountName: Mario Rossi
                    accountType: Personal
                  ebaFraudTaxonomy:
                    initiator: customer
                    method: phishing
                    modus: social engineering
                    labels:
                      - label1
                      - label2
              Bad Request:
                value:
                  accountData:
                    accountBic: FPADITMMXXX
                    accountIban: IT70X0300203280112771851190
                    accountName: Mario Rossi
                    accountType: Personal
                  ebaFraudTaxonomy:
                    initiator: customer
                    method: phishing
                    modus: social engineering
                    labels:
                      - label1
                      - label2
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "Created";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b200") {
            responseName = "Replaced" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
        '401':
          Unauthorized:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b401
            x-sandbox-request-name: Created
        '403':
          Forbidden:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a403
            x-sandbox-request-name: Created
          Forbidden (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b403
            x-sandbox-request-name: Created
        '409':
          Conflict:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b409
            x-sandbox-request-name: Created
        '429':
          Too many requests:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b429
            x-sandbox-request-name: Created
        '500':
          Generic Error:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a500
            x-sandbox-request-name: Created
          Generic Error (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b500
            x-sandbox-request-name: Created
      responses:
        '200':
          description: Replaced
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              examples:
                Replaced:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b29b200
                  value: ''
        '201':
          description: Created
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              examples:
                Created:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b29b201
                  value: ''
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2025-08-08T14:15:22Z
                        code: E400
                        description: Mandatory value missing.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  '/v1/insight-notifications/accounts/search':
    post:
      tags:
        - Insight Notifications
      summary: Search Account Insight Notifications
      description: |
        Search Account Insight Notifications filtered by:
        - a range of insight dates
        - a range of identification dates
        - a specific insight ID
        - a specific case ID

        All filters are mutually excusive. If no results are found, the response is 200 OK with an empty result set.

        Date range endpoints are inclusive (both from and to values are included).

        When the number of matching records exceeds the maximum items per page,
        the response includes a HATEOAS block with `first`, `last`, `previous`, and `next` page links.
      operationId: search-account-insight-notifications
      parameters:
        - schema:
            type: integer
          in: query
          name: page
          description: |
            Report page number requested.
            
            If this page does not exist, an error will be returned.
            
            If this parameter is not provided, the first page will be returned.

        - schema:
            type: integer
          in: query
          name: itemsPerPage
          description: |
            Number of items per page requested.
            
            If this number exceeds the maximum allowed by the system configuration, an error will be returned.
            
            If this parameter is not provided, the maximum allowed number of items per pages will be applied.
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InsightNotificationSearchFilter'
            examples:
              OK:
                value:
                  insightDateFrom: "2025-08-10"
                  insightDateTo: "2025-08-11"
              Bad Request:
                value:
                  insightDateFrom: "2025-08-10"
                  insightDateTo: "2025-08-11"
                  insightId: "0fc905ae-fcb3-4bca-abe7-2d531ceda1ef"
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '200':
          description: OK
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                properties:
                  outcome:
                    type: array
                    description: |
                      This object contains the Account Insight search outcome.
                    items:
                      $ref: '#/components/schemas/InsightAccount'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'
                required:
                  - outcome
              examples:
                OK:
                  value:
                    outcome:
                      - insightContext:
                          insightDate: "2025-08-10"
                          insightId: "a0ef2c84-1a3b-4d9d-9a7f-2b2e5a8b9c10"
                          caseId: "9e2a0d12-7b34-4e51-9f4c-2f2a5a9b1c77"
                          identificationDate: "2025-08-09"
                        accountData:
                          accountBic: "FPADITMMXXX"
                          accountIban: "IT78K0300203280111271851199"
                      - insightContext:
                          insightId: "5f8c6a9b-2d0e-4bb1-9f0a-1b7a2c3d4e5f"
                          insightDate: "2025-08-11"
                          caseId: "b1c2d3e4-f5a6-4789-b0c1-2d3e4f5a6b7c"
                          identificationDate: "2025-08-11"
                        accountData:
                          accountBic: "FPADDEFFXXX"
                          accountIban: "DE89370400440532013000"
                    pagination:
                      currentPage: 1
                      totalPages: 5
                      itemsPerPage: 2
                      links:
                        - rel: "self"
                          href: "/v1/insight-notifications/accounts/search?page=1&itemsPerPage=2"
                        - rel: "next"
                          href: "/v1/insight-notifications/accounts/search?page=2&itemsPerPage=2"
                        - rel: "first"
                          href: "/v1/insight-notifications/accounts/search?page=1&itemsPerPage=2"
                        - rel: "last"
                          href: "/v1/insight-notifications/accounts/search?page=5&itemsPerPage=2"
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Parameter 'senderBic' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '404':
          description: Not Found
          $ref: '#/components/responses/ErrorResponse_404'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  /v1/insight-notifications/accounts/{insightId}:
    delete:
      tags:
        - Insight Notifications
      summary: Delete an Account Insight Notification
      description: >
        This operation allows a PSP to delete an Account Insight Notification, specifying its `insightId`.
      operationId: delete-account-insight-notification
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
        - in: path
          name: insightId
          description: Insight ID of the Account Insight to delete.
          schema:
            type: string
            format: uuid
          required: true
          example: c2375445-b87c-4544-b4c8-d64be603f6de
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "Deleted";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-headers:
              senderBic: FPADITMM
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
        '401':
          Unauthorized:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b401
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '403':
          Forbidden:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a403
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
          Forbidden (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b403
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '404':
          Not Found:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b404
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '409':
          Conflict:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b409
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '429':
          Too many requests:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b429
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '500':
          Generic Error:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a500
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
          Generic Error (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b500
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
      responses:
        '200':
          description: Deleted
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
             examples:
                Deleted:
                  x-sandbox-request-path-params:
                    "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b29b200
                  value: ''
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2025-08-08T14:15:22Z
                        code: E400
                        description: Mandatory value missing.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  /v1/insight-notifications/transactions:
    post:
      tags:
        - Insight Notifications
      summary: Submit an Transaction Insight Notification
      description: >
        This operation allows a PSP to provide a Transaction Insight Notification.If the PSP sumbits an Insight with a insight ID which is already stored in FPAD, the submitted insight will replace the existing one.
      operationId: submit-transaction-insight-notification
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
      requestBody:
        description: ''
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InsightTransactionCore'
            examples:
              Created:
                value:
                  insightContext:
                    insightId: "b62f6d3a-7a01-4d62-81ce-b3ea8cf1b1f0"
                    caseId: "df27a84e-709d-4d56-a82b-2ad1000ed33d"
                    identificationDate: "2025-08-10"
                    fuidRef: "ac04ab78-d704-4d56-b82b-2ad0000ed33d"
                    detectedByFpad: true
                  transactionData:
                    serviceType: "SCTInst"
                    transactionId: "41e400e45"
                    referenceDateTime: "2023-03-23T14:15:22Z"
                    amount: 1000
                    currency: "EUR"
                    categoryPurpose: "ABCD"
                    purposeCode: "ABCD"
                    debtorBic: "FPADITMMXXX"
                    debtorIban: "IT02E0300203280782375262458"
                    debtorName: "Mario Rossi"
                    debtorType: "Personal"
                    creditorBic: "FPFPDEMM441"
                    creditorIban: "DE89370400440532013000"
                    creditorName: "Eric Mulder"
                    creditorType: "Personal"
                  ebaFraudTaxonomy:
                    initiator: "customer"
                    method: "phishing"
                    modus: "social engineering"
                    labels:
                      - "label1"
                      - "label2"
              Replaced:
                value:
                  insightContext:
                    insightId: "b62f6d3a-7a01-4d62-81ce-b3ea8cf1b1f0"
                    caseId: "df27a84e-709d-4d56-a82b-2ad1000ed33d"
                    identificationDate: "2025-08-10"
                    fuidRef: "ac04ab78-d704-4d56-b82b-2ad0000ed33d"
                    detectedByFpad: true
                  transactionData:
                    serviceType: "SCTInst"
                    transactionId: "41e400e45"
                    referenceDateTime: "2023-03-23T14:15:22Z"
                    amount: 1000
                    currency: "EUR"
                    categoryPurpose: "ABCD"
                    purposeCode: "ABCD"
                    debtorBic: "FPADITMMXXX"
                    debtorIban: "IT02E0300203280782375262458"
                    debtorName: "Mario Rossi"
                    debtorType: "Personal"
                    creditorBic: "FPFPDEMM441"
                    creditorIban: "DE89370400440532013000"
                    creditorName: "Eric Mulder"
                    creditorType: "Personal"
                  ebaFraudTaxonomy:
                    initiator: "customer"
                    method: "phishing"
                    modus: "social engineering"
                    labels:
                      - "label1"
                      - "label2"
              Bad Request:
                value:
                  transactionData:
                    serviceType: "SCTInst"
                    transactionId: "41e400e45"
                    referenceDateTime: "2023-03-23T14:15:22Z"
                    amount: 1000
                    currency: "EUR"
                    categoryPurpose: "ABCD"
                    purposeCode: "ABCD"
                    debtorBic: "FPADITMMXXX"
                    debtorIban: "IT02E0300203280782375262458"
                    debtorName: "Mario Rossi"
                    debtorType: "Personal"
                    creditorBic: "FPFPDEMM441"
                    creditorIban: "DE89370400440532013000"
                    creditorName: "Eric Mulder"
                    creditorType: "Personal"
                  ebaFraudTaxonomy:
                    initiator: "customer"
                    method: "phishing"
                    modus: "social engineering"
                    labels:
                      - "label1"
                      - "label2"
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "Created";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b200") {
            responseName = "Replaced" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
        '401':
          Unauthorized:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b401
            x-sandbox-request-name: Created
        '403':
          Forbidden:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a403
            x-sandbox-request-name: Created
          Forbidden (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b403
            x-sandbox-request-name: Created
        '409':
          Conflict:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b409
            x-sandbox-request-name: Created
        '429':
          Too many requests:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b429
            x-sandbox-request-name: Created
        '500':
          Generic Error:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a500
            x-sandbox-request-name: Created
          Generic Error (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b500
            x-sandbox-request-name: Created
      responses:
        '200':
          description: Replaced
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              examples:
                Replaced:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b29b200
                  value: ''
        '201':
          description: Created
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              examples:
                Created:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b29b201
                  value: ''
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2025-08-08T14:15:22Z
                        code: E400
                        description: Mandatory value missing.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  '/v1/insight-notifications/transactions/search':
    post:
      tags:
        - Insight Notifications
      summary: Search Transaction Insight Notifications
      description: |
        Search Transaction Insight Notifications filtered by:
        - a range of insight dates
        - a range of identification dates
        - a specific insight ID
        - a specific case ID

        All filters are mutually excusive. If no results are found, the response is 200 OK with an empty result set.

        Date range endpoints are inclusive (both from and to values are included).

        When the number of matching records exceeds the maximum items per page,
        the response includes a HATEOAS block with `first`, `last`, `previous`, and `next` page links.
      operationId: search-transaction-insight-notifications
      parameters:
        - schema:
            type: integer
          in: query
          name: page
          description: |
            Report page number requested.
            
            If this page does not exist, an error will be returned.
            
            If this parameter is not provided, the first page will be returned.

        - schema:
            type: integer
          in: query
          name: itemsPerPage
          description: |
            Number of items per page requested.
            
            If this number exceeds the maximum allowed by the system configuration, an error will be returned.
            
            If this parameter is not provided, the maximum allowed number of items per pages will be applied.
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InsightNotificationSearchFilter'
            examples:
              OK:
                value:
                  insightDateFrom: "2025-08-08"
                  insightDateTo: "2025-08-11"
              Bad Request:
                value:
                  insightDateFrom: "2025-08-08"
                  insightDateTo: "2025-08-11"
                  insightId: "0fc905ae-fcb3-4bca-abe7-2d531ceda1ef"
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-request-path-params:
              reportId: 7f44452c-5c1d-42f0-8fb8-2df07a5f0f6c
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
      responses:
        '200':
          description: OK
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                type: object
                properties:
                  outcome:
                    type: array
                    description: |
                      This object contains the Account Insight search outcome.
                    items:
                      $ref: '#/components/schemas/InsightTransaction'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'
                required:
                  - outcome
              examples:
                OK:
                  value:
                    outcome:
                      - insightContext:
                          insightDate: 2025-08-10
                          insightId: b62f6d3a-7a01-4d62-81ce-b3ea8cf1b1f0
                          caseId: df27a84e-709d-4d56-a82b-2ad1000ed33d
                          identificationDate: 2025-08-09
                          fuidRef: ac04ab78-d704-4d56-b82b-2ad0000ed33d
                          detectedByFpad: true
                        transactionData:
                          serviceType: SCTInst
                          transactionId: TRX584203
                          referenceDateTime: '2025-08-09T16:12:45Z'
                          amount: 4800.00
                          currency: EUR
                          categoryPurpose: SALA
                          purposeCode: SALA
                          debtorBic: FPADDEFFXXX
                          debtorIban: DE75512108001245126199
                          debtorName: Autohaus Berlin GmbH
                          debtorType: Corporate
                          creditorBic: FPADITMMXXX
                          creditorIban: IT60X0542811101000000123456
                          creditorName: Marco Rossi
                          creditorType: Personal
                        ebaFraudTaxonomy:
                          initiator: customer
                          method: vishing
                          modus: authorised push payment
                          labels:
                            - impersonation
                            - urgent payment request
                      - insightContext:
                          insightId: 3f2a7d91-4b53-4f98-b321-1b2e4a5c6d7e
                          insightDate: 2025-08-09
                          caseId: a17d8c22-9c84-4e77-b0e5-7e8f4d2c5a3b
                          identificationDate: 2025-08-08
                          fuidRef: d91c3b84-2a7f-4f5c-8b2d-1e0f3a4b5c6d
                          detectedByFpad: false
                        transactionData:
                          serviceType: SCT
                          transactionId: TRX982374
                          referenceDateTime: '2023-04-15T10:30:45Z'
                          amount: 2500.75
                          currency: EUR
                          categoryPurpose: RENT
                          purposeCode: RENT
                          debtorBic: FPADDEFFXXX
                          debtorIban: DE89370400440532013000
                          debtorName: Hans Müller
                          debtorType: Corporate
                          creditorBic: FPADFRPPXXX
                          creditorIban: FR1420041010050500013M02606
                          creditorName: Jean Dupont
                          creditorType: Personal
                        ebaFraudTaxonomy:
                          initiator: fraudster
                          method: malware
                          modus: account takeover
                          labels:
                            - malware
                            - credential theft
                    pagination:
                      currentPage: 1
                      totalPages: 5
                      itemsPerPage: 2
                      links:
                        - rel: "self"
                          href: "/v1/insight-notifications/transactions/search?page=1&itemsPerPage=2"
                        - rel: "next"
                          href: "/v1/insight-notifications/transactions/search?page=2&itemsPerPage=2"
                        - rel: "first"
                          href: "/v1/insight-notifications/transactions/search?page=1&itemsPerPage=2"
                        - rel: "last"
                          href: "/v1/insight-notifications/transactions/search?page=5&itemsPerPage=2"
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Parameter 'senderBic' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '404':
          description: Not Found
          $ref: '#/components/responses/ErrorResponse_404'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  /v1/insight-notifications/transactions/{insightId}:
    delete:
      tags:
        - Insight Notifications
      summary: Delete a Transaction Insight Notification
      description: >
        This operation allows a PSP to delete a Transaction Insight Notification, specifying its `insightId`.
      operationId: delete-transaction-insight-notification
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
        - in: path
          name: insightId
          description: Insight ID of the Transaction Insight to delete.
          schema:
            type: string
            format: uuid
          required: true
          example: c2375445-b87c-4544-b4c8-d64be603f6de
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "Deleted";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '400':
          Bad Request:
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
        '401':
          Unauthorized:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b401
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '403':
          Forbidden:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a403
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
          Forbidden (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b403
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '404':
          Not Found:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b404
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '409':
          Conflict:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b409
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '429':
          Too many requests:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b429
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
        '500':
          Generic Error:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a500
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
          Generic Error (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b500
            x-sandbox-request-path-params:
              "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
      responses:
        '200':
          description: Deleted
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              examples:
                Deleted:
                  x-sandbox-request-path-params:
                    "insightId": "4ac04478-d70d-4d25-8bde-f2ad0001093d"
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b29b200
                  value: ''
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2025-08-08T14:15:22Z
                        code: E400
                        description: Mandatory value missing.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'
  /v1/eds/local-file:
    get:
      tags:
        - EDS
      summary: Retrieve the EDS local file in the format specified
      description: |
        This operation returns a ZIP file containing the EDS local file, in the specified format and for the requested date, and its checksum.
        If not specified, the current date is used by default.
        The date must not be more than 8 days prior to the current date.

        If no file is found for the requested date and format, a **204 No Content** response will be returned.
      operationId: get-eds-local-file
      parameters:
        - $ref: '#/components/parameters/senderBic'
        - $ref: '#/components/parameters/pri'
        - name: fileFormat
          description: The requested format of the EDS local file.
          in: query
          schema:
            type: string
            enum:
              - XML
              - CSV
              - JSON
          required: true
        - name: fileDate
          description: |
            The date for which the EDS Local File is required.
            If not specified, the current date is used by default.
            The specified date must not be earlier than 8 days before the current date.
          in: query
          schema:
            type: string
            format: date
      x-sandbox-rule-type: SCRIPT_JS
      x-sandbox-rule-content: |
        var responseName = "OK";
        var pri = camelHeaders['pri'];
        if (pri === "a206e009-ef37-4040-924d-db758b29b400") {
            responseName = "Bad Request" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b204") {
            responseName = "No Content" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b401") {
            responseName = "Unauthorized" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a403") {
            responseName = "Forbidden" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b403") {
            responseName = "Forbidden (application managed)" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b404") {
            responseName = "Not Found" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b409") {
            responseName = "Conflict" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b429") {
            responseName = "Too many requests" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29a500") {
            responseName = "Generic Error" ;
        }
        else if (pri === "a206e009-ef37-4040-924d-db758b29b500") {
            responseName = "Generic Error (application managed)" ;
        }
        else if (!!validationErrors && validationErrors.length > 0) {
            responseName = "Bad Request" ;
        }
        responseName;
      x-sandbox-response-extension:
        '204':
          No Content:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b204
            x-sandbox-request-query-params:
              fileFormat: XML
        '400':
          Bad Request:
            x-sandbox-request-headers:
              senderBic: FPADITMM
              pri: a206e009-ef37-4040-924d-db758b29b400
            x-sandbox-request-query-params:
              fileFormat: XML
            x-sandbox-response-body: |
              {
                "errors": [
                  <#if validationErrors??>
                    <#list validationErrors as error>
                      {
                        "dateTime": "2019-08-24T14:15:22Z",
                        "code": "${error.code}",
                        "description": "${error.message}"
                      }<#if error?has_next>,</#if>
                    </#list>
                    <#else>
                  {
                    "dateTime": "2019-08-24T14:15:22Z", 
                    "code":"E400", 
                    "description": "Type mismatch"
                  }
                  </#if>
                ]
              }
        '401':
          Unauthorized:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b401
            x-sandbox-request-query-params:
              fileFormat: XML
        '403':
          Forbidden:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a403
            x-sandbox-request-query-params:
              fileFormat: XML
          Forbidden (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b403
            x-sandbox-request-query-params:
              fileFormat: XML
        '404':
          Not Found:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b404
            x-sandbox-request-query-params:
              fileFormat: XML
        '409':
          Conflict:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b409
            x-sandbox-request-query-params:
              fileFormat: XML
        '429':
          Too many requests:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b429
            x-sandbox-request-query-params:
              fileFormat: XML
        '500':
          Generic Error:
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29a500
            x-sandbox-request-query-params:
              fileFormat: XML
          Generic Error (application managed):
            x-sandbox-request-headers:
              pri: a206e009-ef37-4040-924d-db758b29b500
            x-sandbox-request-query-params:
              fileFormat: XML
      responses:
        '200':
          description: OK
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
              examples:
                OK:
                  x-sandbox-request-headers:
                    senderBic: FPADITMM
                    pri: a206e009-ef37-4040-924d-db758b2950b2
                  x-sandbox-request-query-params:
                    fileFormat: XML
                  value: UEsDBBQAAAAIAKly7lo+295EJwAAACUAAAAIAAAAdGVzdC50eHRzzs8rSc0rLclXSMlUSC1OzS3IzFfIzFMozVNIy8xJVajKLNDjAgBQSwECFAMUAAAACACpcu5aPtveRCcAAAAlAAAACAAAAAAAAAAAAAAAgAEAAAAAdGVzdC50eHRQSwUGAAAAAAEAAQA2AAAATQAAAAAA
        '204':
          description: No Content
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          content:
            plain/text:
              schema:
                type: string
              examples:
                No Content:
                  value: ''
        '400':
          description: Bad Request
          headers:
            fri:
              $ref: '#/components/headers/FpadResponseIdentifier'
          x-sandbox-request-query-params:
            fileFormat: XML
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                Bad Request:
                  value:
                    errors:
                      - dateTime: 2019-08-24T14:15:22Z
                        code: E400
                        description: Field 'fileType' is required.
        '401':
          description: Unauthorized
          $ref: '#/components/responses/ErrorResponse_401'
        '403':
          description: Forbidden
          $ref: '#/components/responses/ErrorResponse_403'
        '404':
          description: Not Found
          $ref: '#/components/responses/ErrorResponse_404'
        '409':
          description: Conflict
          $ref: '#/components/responses/ErrorResponse_409'
        '429':
          description: Too many requests
          $ref: '#/components/responses/ErrorResponse_429'
        '500':
          description: Generic Error
          $ref: '#/components/responses/ErrorResponse_500'  
components:
  parameters:
    senderBic:
      name: senderBic
      in: header
      description: BIC of the participant sending the request.
      required: true
      schema:
        $ref: '#/components/schemas/Bic8'
      example: FPADITMM
    pri:
      name: pri
      in: header
      description: |
        Participant Request Identifier - The sender Participant must set this value with an identifier of the request that must be unique for the Participant itself.
      required: true
      schema:
        type: string
        format: uuid
      example: a206e009-ef37-4040-924d-db758b2950b2
    fuid:
      name: fuid
      in: path
      required: true
      schema:
        type: string
        format: uuid
      description: FPAD Unique Identifier of the risk info evaluation to seek.
      example: 9d356e83-63a7-4763-92fc-52aa7bf4a21f
  headers:
    FpadResponseIdentifier:
      description: |
        FPAD (API) Response Identifier - A Universal Unique Identifier (UUID) associated by FPAD to the API response.
      schema:
        type: string
        format: uuid
        examples:
          - 0d1d7e3a-e2c2-48da-83ff-9920eaad8c93
    pri:
      description: |
        Participant Request Identifier - The sender Participant must set this value with an identifier of the request that must be unique for the Participant itself.
      required: true
      schema:
        type: string
        format: uuid
      example: a206e009-ef37-4040-924d-db758b2950b2
  schemas:
    AccountCategory:
      description: Account type.
      type: string
      enum:
        - Personal
        - Corporate
        - Unknown
    AccountType:
      type: object
      properties:
        iban:
          $ref: '#/components/schemas/IBANType' 
      required:
        - iban
    AgentType:
      type: object
      properties:
        financialInstitutionId:
          type: object
          properties:
            bicfi:
              $ref: '#/components/schemas/BICType'
          required:
            - bicfi
      required:
        - financialInstitutionId
    Amount:
      type: number
      description: Standard amount.
      format: double
      maximum: 999999999999.99
      examples:
        - 1048.27
    AssessmentTransactionData:
      type: object
      description: |
        Structure of a transaction assessment request, with all data of a
        potential transaction that will be evaluated.
      properties:
        serviceType:
          $ref: '#/components/schemas/ServiceType'
        transactionId:
          type: string
          description: >
            Unique identifier of the potential transaction which can be set by
            the sender Participant (It could correspond to the actual
            Transaction ID,  used in the EBA CLEARING STEP2/RT1 Services if
            already assigned by the Participant itself at the time of the
            assessment request).
          maxLength: 35
        debtorName:
          type: string
          description: |
            Name associated with the Debtor's Account present in the potential transaction that has to be assessed.
        debtorBic:
          $ref: '#/components/schemas/Bic'
          description: |
            BIC of the Agent managing the Debtor's Account present in the
            potential transaction that has to be assessed.
        debtorIban:
          $ref: '#/components/schemas/Iban'
          description: IBAN of the debtor
        creditorName:
          type: string
          description: |
            Name associated with the Creditor's Account present in the potential transaction that has to be assessed.
        creditorBic:
          $ref: '#/components/schemas/Bic'
          description: |
            BIC of the Agent managing the Creditor's Account present in the
            potential transaction that has to be assessed.
        creditorIban:
          $ref: '#/components/schemas/Iban'
          description: |
            IBAN identifies the Creditor's Account present in the potential
            transaction that has to be assessed.
        amount:
          $ref: '#/components/schemas/Amount'
          description: Amount of the potential transaction that has to be assessed.
        currency:
          $ref: '#/components/schemas/Currency'
          description: |
            Currency of the Amount of the potential transaction that has to be assessed.
        referenceDateTime:
          $ref: '#/components/schemas/DateTime'
          description: "Reference date and time of the potential transaction that has to be assessed.\r\nIt must me intended as *settlementDate* for SCT and *acceptanceDateTime* for SCTInst services."
        categoryPurpose:
          type: string
          description: |
            Category Purpose of the potential transaction that has to be
            assessed.
          minLength: 4
          maxLength: 4
        purposeCode:
          type: string
          description: Purpose Code of the potential transaction that has to be assessed.
          minLength: 1
          maxLength: 4
      required:
        - serviceType
        - debtorName
        - debtorBic
        - debtorIban
        - creditorName
        - creditorBic
        - creditorIban
        - amount
        - currency
    Bic:
      type: string
      title: ''
      description: Business Identifier Code (BIC) in 8 or 11 characters format.
      pattern: '[A-Z0-9]{4,4}[A-Z]{2,2}[A-Z0-9]{2,2}([A-Z0-9]{3,3}){0,1}'
      examples:
        - FPADITMMXXX
    Bic8:
      type: string
      title: ''
      description: Business Identifier Code (BIC) in 8 characters format.
      pattern: '[A-Z0-9]{4,4}[A-Z]{2,2}[A-Z0-9]{2,2}'
      minLength: 8
      maxLength: 8
      examples:
        - FPADITMM
    BICType: 
      type: string
      pattern: '^[A-Z0-9]{4,4}[A-Z]{2,2}[A-Z0-9]{2,2}([A-Z0-9]{3,3}){0,1}$'
      examples:
        - 'ABCDBEBBFIM'
    Currency:
      type: string
      title: ''
      description: ISO 4217 currency code.
      pattern: '[A-Z]{3}'
      examples:
        - EUR
    DateTime:
      type: string
      title: ''
      description: Timestamp in ISO 8601 format.
      format: date-time
      examples:
        - '2019-08-24T14:15:22Z'
    EbaFraudTaxonomy:
      description: Fraud classification according to the EBA Fraud Taxonomy.
      type: object
      properties:
        initiator:
          description: |
            Describes who initiates the payment transaction affected by the fraud, i.e. the customer or the fraudster. The initiator section includes ‘first party’ as an optional element relevant, primarily, to card fraud.
          type: string
        method:
          description: |
            Describes the attack vector and specifies the first point of contact between the fraudster and the victim or the point of compromise.
          type: string
        modus:
          description: |
            Describes the unauthorised and often manipulative action taken by the fraudster and resulting in the loss of money via a payment transaction. These actions are clustered within high-level classifications reflecting the strategic approach deployed by the fraudster. For each modus, a definition is provided based on an authoritative and publicly available source, wherever possible.
          type: string
        labels:
          description: |
            To ensure ease of use and maximum flexibility, the EBA Fraud Taxonomy provides the possibility to enrich the case with additional categorisation information on a voluntary basis using labels or tags. The labels/tags listed in the taxonomy are suggestions and not meant to be exhaustive. Individual PSPs remain free to choose labels/tags for specific fraud scenarios as they deem fit, for example to align with internal reporting requirements. For each label/tag, a definition is provided based on an authoritative and publicly available source, wherever possible.
          type: array
          items:
            type: string
    ErrorResponse:
      description: |
        Structure describing FPAD error response, with a mandatory array of
        errors, each one with code, description and the timestamp of when it occurred.
      type: object
      properties:
        errors:
          type: array
          minItems: 1
          items:
            type: object    
            properties:
              dateTime:
                $ref: '#/components/schemas/DateTime'
              code:
                type: string
                description: |
                  A four character string representing the FPAD error
                  code.
                minLength: 4
                maxLength: 4
              description:
                type: string
                description: A string containing the error description.
            required:
              - dateTime
              - code
              - description
    FpadUniqueIdentifier:
      type: string
      description: FPAD Unique Identifier (a UUID specified by RFC4122).
      format: uuid
      examples:
        - 4ac04478-d70d-4d25-8bde-f2ad0001093d
    GenericOrganisationIdentification:
      description: | 
        Usage Rule: the use of either ‘schemeNameCode’ or ‘schemeNameProprietary’ is mandatory when the ‘identification code’ is used.
        Mutual exclusion is verified by business rules executed after the json parsing.
      type: object
      properties:
        identification:
          description: Unique and unambiguous identification of an organisation.
          allOf:
            - $ref: '#/components/schemas/Max256Text'
        schemeNameCode:
          description: An entry provided by an external ISO code list.
          allOf:
            - $ref: '#/components/schemas/OrganisationIdentificationCode'
        schemeNameProprietary:
          description: A scheme name defined in a proprietary way.
          allOf:
            - $ref: '#/components/schemas/Max35Text'
        issuer:
          description: Issuer of the identification.
          allOf:
            - $ref: '#/components/schemas/Max35Text'
      required:
        - identification
    HateoasBlock:
      title: ''
      type: object
      description: Generic structure of a HATEOAS block.
      properties:
        rel:
          type: string
          description: |
            It defines the *relation* (i.e. the description) of the resource retrieved by the *href* attribute.
        href:
          type: string
          description: URI of the related resource.
      required:
        - rel
        - href
      examples:
        - rel: next
          href: |
            /transactions/investigations/reports/fc91e31c-820f-4a9e-94ba-371cb2dcaa1d?page=2
    Iban:
      type: string
      title: ''
      description: International Bank Account Number (IBAN).
      pattern: '[A-Z]{2,2}[0-9]{2,2}[a-zA-Z0-9]{1,30}'
      examples:
        - IT78K0300203280111271851199
    IBANType: 
      type: string
      pattern: '^[A-Z]{2,2}[0-9]{2,2}[a-zA-Z0-9]{1,30}$'
    InsightAccount:
      description: Content of an Account Insight Notification.
      type: object
      properties:
        insightContext:
          $ref: '#/components/schemas/InsightNotificationContext'
        accountData:
          $ref: '#/components/schemas/InsightAccountData'
        ebaFraudTaxonomy:
          description: Fraud classification according to the EBA Fraud Taxonomy.
          $ref: '#/components/schemas/EbaFraudTaxonomy'
      required:
        - insightContext
        - accountData
    InsightAccountCore:
      description: Content of an Account Insight Notification for submission.
      type: object
      properties:
        insightContext:
          $ref: '#/components/schemas/InsightNotificationContextCore'
        accountData:
          $ref: '#/components/schemas/InsightAccountData'
        ebaFraudTaxonomy:
          description: Fraud classification according to the EBA Fraud Taxonomy.
          $ref: '#/components/schemas/EbaFraudTaxonomy'
      required:
        - insightContext
        - accountData
    InsightAccountData:
      type: object
      description: Account data used in Insight Notifications.
      properties:
        accountBic:
          $ref: '#/components/schemas/Bic'
        accountIban:
          $ref: '#/components/schemas/Iban'
        accountName:
          description: Name associated to the account IBAN.
          $ref: '#/components/schemas/Max140Text'
        accountType:
          $ref: '#/components/schemas/AccountCategory'
      required:
        - accountBic
        - accountIban
    InsightNotificationContext:
      description: Header with identification information present in every Insight Notification.
      allOf:
        - type: object
          properties:
            insightDate:
              description: Creation date of the Insight Notification.
              type: string
              format: date
          required:
            - insightDate
        - $ref: '#/components/schemas/InsightNotificationContextCore'
    InsightNotificationContextCore:
      type: object
      description: Header with identification information present in every Insight Notification.
      properties:
        insightId:
          description: Insight Notification Identifier.
          type: string
          format: uuid
        caseId:
          description: Case Identifier. It should identify related data (for instance multiple transactions associated with a single fraud case).
          type: string
          format: uuid
        identificationDate:
          description: Date on which the fraudulent activity or case was first detected or flagged.
          type: string
          format: date
        fuidRef:
          description: FUID reference. If specified, it refers to a transaction or account previously assessed by FPAD.
          $ref: '#/components/schemas/FpadUniqueIdentifier'
        detectedByFpad:
          description: It indicates that the item was detected by FPAD.
          type: boolean
      required:
        - insightId
    InsightNotificationSearchFilter:
      oneOf:
        - title: 'Search by insight date'
          type: object
          properties:
            insightDateFrom:
              type: string
              format: date
              description: |
                Start of the **insight date** range (inclusive). ISO 8601 date (YYYY-MM-DD).
                Must be <= `insightDateTo` when both are provided.
              examples:
                - "2025-08-01"
            insightDateTo:
              type: string
              format: date
              description: |
                End of the **insight date** range (inclusive). ISO 8601 date (YYYY-MM-DD).
                Must be >= `insightDateFrom` when both are provided.
              examples:
                - "2025-08-10"
          minProperties: 1
          additionalProperties: false
        - title: 'Search by identification date'
          type: object
          properties:
            identificationDateFrom:
              type: string
              format: date
              description: |
                Start of the **identification date** range (inclusive). ISO 8601 date (YYYY-MM-DD).
                Must be <= `identificationDateTo` when both are provided.
              examples:
                - "2025-07-01"
            identificationDateTo:
              type: string
              format: date
              description: |
                End of the **identification date** range (inclusive). ISO 8601 date (YYYY-MM-DD).
                Must be >= `identificationDateFrom` when both are provided.
              examples:
                - "2025-07-31"
          minProperties: 1
          additionalProperties: false
        - title: 'Search by insight ID'
          type: object
          properties:
            insightId:
              type: string
              description: Unique Identifier.
              examples:
                - "0fc905ae-fcb3-4bca-abe7-2d531ceda1ef"
          minProperties: 1
          additionalProperties: false
        - title: 'Search by case ID'
          type: object
          properties:
            caseId:
              type: string
              description: Unique case identifier.
              examples:
                - "d3db10a9-c7a5-4eb4-862e-9477593671fa"
          minProperties: 1
          additionalProperties: false
    InsightTransaction:
      description: Content of a Transaction Insight Notification.
      type: object
      properties:
        insightContext:
          $ref: '#/components/schemas/InsightNotificationContext'
        transactionData:
          $ref: '#/components/schemas/InsightTransactionData'
        ebaFraudTaxonomy:
          description: Fraud classification according to the EBA Fraud Taxonomy.
          $ref: '#/components/schemas/EbaFraudTaxonomy'
      required:
        - insightContext
        - transactionData
    InsightTransactionCore:
      description: Content of a Transaction Insight Notification for submission.
      type: object
      properties:
        insightContext:
          $ref: '#/components/schemas/InsightNotificationContextCore'
        transactionData:
          $ref: '#/components/schemas/InsightTransactionData'
        ebaFraudTaxonomy:
          description: Fraud classification according to the EBA Fraud Taxonomy.
          $ref: '#/components/schemas/EbaFraudTaxonomy'
      required:
        - insightContext
        - transactionData
    InsightTransactionData:
      type: object
      description: Transaction data used in Insight Notifications.
      properties:
        serviceType:
          $ref: '#/components/schemas/ServiceType'
        transactionId:
          type: string
          description: Unique identifier of the transaction for the participant.
          maxLength: 35
        referenceDateTime:
          $ref: '#/components/schemas/DateTime'
          description: "Reference date and time of the transaction.\r\nIt must be intended as *settlementDate* for SCT and *acceptanceDtateTime* for SCTInst transactions."
        amount:
          $ref: '#/components/schemas/Amount'
          description: Amount of the transaction.
        currency:
          $ref: '#/components/schemas/Currency'
          description: Currency of the Amount of the transaction.
        categoryPurpose:
          type: string
          description: Category Purpose of the transaction.
          minLength: 4
          maxLength: 4
        purposeCode:
          type: string
          description: Purpose Code of the transaction.
          minLength: 1
          maxLength: 4
        debtorBic:
          $ref: '#/components/schemas/Bic'
          description: |
            BIC of the Agent managing the Debtor's Account present in the
            transaction.
        debtorIban:
          $ref: '#/components/schemas/Iban'
          description: IBAN of the debtor.
        debtorName:
          type: string
          description: |
            Name associated with the Debtor's Account present in the
            transaction.
        debtorType:
          $ref: '#/components/schemas/AccountCategory'
          description: Account type of he debtor.
        creditorBic:
          $ref: '#/components/schemas/Bic'
          description: |
            BIC of the Agent managing the Creditor's Account present in the
            transaction.
        creditorIban:
          $ref: '#/components/schemas/Iban'
          description: IBAN identifies the Creditor's Account present in the transaction.
        creditorName:
          type: string
          description: |
            Name associated with the Creditor's Account present in the
            transaction.
        creditorType:
          $ref: '#/components/schemas/AccountCategory'
          description: Account type of he creditor.
      required:
        - serviceType
        - transactionId
        - referenceDateTime
        - amount
        - currency
        - debtorBic
        - creditorBic
    InvestigationTransactionData:
      type: object
      description: Basic structure with all key elements of a transaction.
      examples:
        - serviceType: SCT
          instructingAgentBic: FPADITMM
          instructedAgentBic: FPADITMM
          transactionId: string
          debtorName: string
          debtorBic: FPADITMMXXX
          debtorIban: IT78K0300203280111271851199
          creditorName: string
          creditorBic: FPADITMMXXX
          creditorIban: IT78K0300203280111271851199
          amount: 340.75
          currency: EUR
          referenceDateTime: '2019-08-24T14:15:22Z'
          categoryPurpose: ABCD
          purposeCode: ABCD
      properties:
        instructingAgentBic:
          $ref: '#/components/schemas/Bic8'
          description: |
            BIC of the instructing Agent for the transaction.
        instructedAgentBic:
          $ref: '#/components/schemas/Bic8'
          description: |
            BIC of the instructed Agent for the transaction.
        serviceType:
          $ref: '#/components/schemas/ServiceType'
        transactionId:
          type: string
          description: Unique identifier of the transaction for the participant.
          maxLength: 35
        debtorName:
          type: string
          description: |
            Name associated with the Debtor's Account present in the
            transaction.
        debtorBic:
          $ref: '#/components/schemas/Bic'
          description: |
            BIC of the Agent managing the Debtor's Account present in the
            transaction.
        debtorIban:
          $ref: '#/components/schemas/Iban'
          description: IBAN of the debtor.
        creditorName:
          type: string
          description: |
            Name associated with the Creditor's Account present in the
            transaction.
        creditorBic:
          $ref: '#/components/schemas/Bic'
          description: |
            BIC of the Agent managing the Creditor's Account present in the
            transaction.
        creditorIban:
          $ref: '#/components/schemas/Iban'
          description: IBAN identifies the Creditor's Account present in the transaction.
        amount:
          $ref: '#/components/schemas/Amount'
          description: Amount of the transaction.
        currency:
          $ref: '#/components/schemas/Currency'
          description: Currency of the Amount of the transaction.
        referenceDateTime:
          $ref: '#/components/schemas/DateTime'
          description: "Reference date and time of the transaction.\r\nIt must be intended as *settlementDate* for SCT and *acceptanceDtateTime* for SCTInst transactions."
        categoryPurpose:
          type: string
          description: Category Purpose of the transaction.
          minLength: 4
          maxLength: 4
        purposeCode:
          type: string
          description: Purpose Code of the transaction.
          minLength: 1
          maxLength: 4
      required:
        - serviceType
        - transactionId
        - debtorName
        - debtorBic
        - debtorIban
        - creditorName
        - creditorBic
        - creditorIban
        - amount
        - currency
        - referenceDateTime
    LEIType: 
      type: string
      pattern: '^[A-Z0-9]{18}[0-9]{2}$'
      description: "Code LEI (Legal Entity Identifier) ISO 17442"
      examples:
        - '549300DTUYXVMJXZNY75'
    MessageCode:
      type: string
      enum: [FORMAT_ERROR, CLIENT_INVALID, CLIENT_INCONSISTENT, TIMESTAMP_INVALID]
    Max35Text:
      type: string
      minLength: 0
      maxLength: 35
    Max70Text:
      type: string
      minLength: 0
      maxLength: 70
    Max140Text:
      type: string
      minLength: 0
      maxLength: 140
    Max256Text:
      type: string
      minLength: 0
      maxLength: 256
    Max500Text:
      type: string
      minLength: 0
      maxLength: 500
    Message:
      title: ''
      type: object
      description: |
        Basic structure for reporting messages. Typically used for providing descriptions about warnings and errors.
      examples:
        - messageType: WARNING
          messageCode: W001
          messageText: Partial outcome.
      properties:
        messageType:
          type: string
          description: Message type.
          enum:
            - INFO
            - WARNING
            - ERROR
        messageCode:
          type: string
          description: Message code.
        messageText:
          type: string
          description: Full textual description of the message.
      required:
        - messageType
        - messageCode
        - messageText
    ModelItem:
      type: object
      title: ''
      description: Structure with elements identifying a model item.
      properties:
        modelName:
          $ref: '#/components/schemas/ModelName'
        modelVersion:
          $ref: '#/components/schemas/ModelVersion'
      required:
        - modelName
    ModelName:
      type: string
      description: |
        It's the name of a specific model. Together with the model version it becomes a unique identifier of a specific model.
      maxLength: 20
    ModelVersion:
      type: string
      description: |
        It states the version of model identified by modelName that has been applied.
      maxLength: 15
    ModelOutcome:
      type: string
      maxLength: 10
      description: |
        Risk assessment Value produced by an applied FPAD's Model that can be provided in the outcome of a Prevention assessment (as part of a RiskInforArray). The format of the Value depends on the type of Model (to consult the structure of the Value produced by an FPAD Model, refer to the specific EBA CLEARING reference documentation).
    ModelNarratives:
      type: string
      maxLength: 120
      description: |
        It is an optional attribute that can be provided in addition to the main Model Outcome expected from the result calculation of a Model.
        A *narrative* represents a single machine-readable code or a concatenation of multiple codes separated by the character "+" as a delimiter (e.g. LOWACT+FTMACC, where LOWACT stands for "LOW ACTIVITY" and FTMACC for "First-time account").
        The list of Narrative codes is defined by EBA CLEARING and provided to Participants in the reference documentation.
    MuleAccountInvestigationReportFilter:
      type: object
      properties:
        accountRole:
          description: Only accounts involved with this role are selected.
          $ref: '#/components/schemas/MuleAccountRole'
        accountBic:
          description: |
            It defines the search scope as follows: 

            - If it is a BIC11, with the first BIC8 equal to *senderBic*:
              - if last 3 characters are 'XXX'*, it looks for mule accounts in Participant's BIC (including all branches) IBANs.
              - if last 3 characters are different from 'XXX' it looks for mule accounts in the specified Participant's BIC branch.
            - If it is a BIC11, with the first BIC8 different from *senderBic*:
              - if last 3 characters are 'XXX'*, it looks for mule accounts in Participant's RB/APSP BIC (including all branches) IBANs.
              - if last 3 characters are different from 'XXX' it looks for mule accounts in the specified Participant's RB/APSP BIC branch.
            - If it is a BIC8, it must be equal to *senderBic* and it looks for mule accounts in both Participant BIC and all RB/APSP BICs (global search).
          $ref: '#/components/schemas/Bic'
        accountIban:
          description: If specified, only this IBAN is selected.
          $ref: '#/components/schemas/Iban'
        caseDateFrom:
          description: Minimum triggering date of a mule account analysis case.
          type: string
          format: date
        caseDateTo:
          description: Maximum triggering date of a mule account analysis case.
          type: string
          format: date
        muleRiskIndicatorFrom:
          description: Minimum Mule Risk Indicator value.
          type: number
        muleRiskIndicatorTo:
          description: Maximum Mule Risk Indicator value.
          type: number
      required:
        - accountRole
        - accountBic
        - caseDateFrom
        - caseDateTo
    MuleAccountRole:
      description: Mule Account role
      type: string
      enum:
        - REPORTED
        - LINKED
        - ALL
    NameMatchType:
      type: string
      enum: [MTCH, CMTC, NMTC, NOAP]
    OrganisationIdentificationCode:
      description: Specifies the external organisation identification scheme name code (maximum 4 characters) as defined in an external list (iso20022.org).
      type: string
      enum: [BANK, CBID, CHID, CINC, COID, CUST, DUNS, EMPL, GS1G, SREN, SRET, TXID, BDID, BOID]
      examples:
        - 'BOID'
    PaginationInfo:
      title: ''
      type: object
      properties:
        currentPage:
          type: integer
          description: Current page number.
        totalPages:
          type: integer
          description: Total number of pages, calculated by dividing the total number of reports retrieved by the number of items per page applied (rounded up).
        itemsPerPage:
          type: integer
          description: Number of items per page (as requested by the user or applied by default, if not specified).
        links:
          type: array
          description: |
            HATEOAS block containing references to pagination links: prev, next, first, last, self.
          items:
            $ref: '#/components/schemas/HateoasBlock'
      required:
        - currentPage
        - totalPages
        - itemsPerPage
        - links
    PartyIdMatchType:
      type: string
      enum: [MTCH, NMTC, NOAP]  
    PartyType:
      description: | 
        Separation of the two kinds of identification into distinct structures ensures that the two sets of attributes are mutually exclusive.
        Mutual exclusion is verified by business rules executed after the json parsing.
      type: object
      properties:
          name: 
            $ref: '#/components/schemas/Max140Text'
          identification:
            type: object
            properties:
              organisationId:
                type: object
                properties:
                  lei:
                    description: Legal Entity Identifier.
                    allOf:
                      - $ref: '#/components/schemas/LEIType'
                  anyBIC:
                    $ref: '#/components/schemas/BICType'
                  others:
                    description: | 
                      Unique identification of an organisation, as assigned by an institution, using an identification scheme.
                      Usage Rule: only one entry to be used.
                    type: array
                    items: 
                      $ref: '#/components/schemas/GenericOrganisationIdentification'
            required:
              - organisationId
    Ria:
      title: ''
      type: object
      description: |
        The Ria is a version of *RiskInfoArray* with compact attribute names to save space in bulk requests. It is an array where each item represents an assessed risk for the Account(s) under evaluation, according to the Participant's request. The item model is identified by the *modelName* and the *modelVersion* properties, while the risk assessment is identified by the *value* property.
      properties:
        name:
          $ref: '#/components/schemas/ModelName'
        ver:
          $ref: '#/components/schemas/ModelVersion'
        out:
          $ref: '#/components/schemas/ModelOutcome'
        narr:
          $ref: '#/components/schemas/ModelNarratives'
      required:
        - name
        - ver
        - out
    RiskInfoArray:
      type: array
      description: |
        The RiskInfoArray is an array where each item represents an assessed
        risk for the Account(s) under evaluation, according to the Participant's
        request. The item model is identified by the *modelName* and the
        *modelVersion* properties, while the risk assessment is identified by
        the *value* property.
      items:
        type: object
        properties:
          modelName:
            $ref: '#/components/schemas/ModelName'
          modelVersion:
            $ref: '#/components/schemas/ModelVersion'
          modelOutcome:
            $ref: '#/components/schemas/ModelOutcome'
          modelNarratives:
            $ref: '#/components/schemas/ModelNarratives'
        required:
          - modelName
          - modelVersion
          - modelOutcome
    ServiceType:
      type: string
      enum:
        - SCT
        - SCTInst
      description: 'EBA CLEARING Service type (SCT, SCTInst).'
    ShortErrorResponse:
      description: |
        Compact version of ErrorResponse structure, used in bulk endpoints.
      type: object
      properties:
        xid:
          type: string
          format: uuid
          description: The same *xid* sent in the bulk request, for matching purpose.
        err:
          type: array
          minItems: 1
          items:
            type: object    
            properties:
              dt:
                $ref: '#/components/schemas/DateTime'
              code:
                type: string
                description: |
                  A four character string representing the FPAD error
                  code.
                minLength: 4
                maxLength: 4
              desc:
                type: string
                description: A string containing the error description.
            required:
              - dt
              - code
              - desc
    ShortMessage:
      title: ''
      type: object
      description: |
        Basic structure for reporting messages. Typically used for providing descriptions about warnings and errors.
      properties:
        type:
          type: string
          description: Message type.
          enum:
            - INFO
            - WARNING
            - ERROR
        code:
          type: string
          description: Message code.
        text:
          type: string
          description: Full textual description of the message.
      required:
        - type
        - code
        - text
    TransactionInvestigationReportFilter:
      type: object
      description: Data structure user as extraction filter for report request.
      properties:
        instructingAgentBic:
          $ref: '#/components/schemas/Bic8'
          description: BIC of the instructing agent.
        instructedAgentBic:
          $ref: '#/components/schemas/Bic8'
          description: BIC of the instructed agent.
        serviceType:
          $ref: '#/components/schemas/ServiceType'
          description: Service Type of considered transactions.
        transactionId:
          type: string
          description: Unique identifier of the transaction.
          maxLength: 35
        debtorName:
          type: string
          description: "Name associated with the Debtor's Account present in the transaction.\r\nAll transactions starting with the value assigned will be considered."
        debtorBic:
          $ref: '#/components/schemas/Bic'
          description: "BIC of the Agent managing the Debtor's Account present in the transaction.\r\nIf a 8 characters BIC is assigned as value, all transactions having a debtorBic starting with the same 8 characters will be considered. "
        debtorIban:
          $ref: '#/components/schemas/Iban'
          description: IBAN of the debtor
        creditorName:
          type: string
          description: "Name associated with the Creditor's Account present in the transaction.\r\n All transactions starting with the value assigned will be considered."
        creditorBic:
          $ref: '#/components/schemas/Bic'
          description: "BIC of the Agent managing the Creditor's Account present in the transaction.\r\nIf a 8 characters BIC is assigned as value, all transactions having a creditorBic starting with the same 8 characters will be considered. "
        creditorIban:
          $ref: '#/components/schemas/Iban'
          description: |
            IBAN identifies the Creditor's Account present in the potential
            transaction that has to be assessed.
        minAmount:
          $ref: '#/components/schemas/Amount'
          description: Minumum amount of the transaction.
        maxAmount:
          $ref: '#/components/schemas/Amount'
          description: Maximum amount of the transaction.
        currency:
          $ref: '#/components/schemas/Currency'
          description: Currency of the Amount of the transaction.
        minReferenceDateTime:
          $ref: '#/components/schemas/DateTime'
          description: "Minimum reference date and time.\r\nReference Date Time must be intended as *settlementDate* for SCT and *acceptanceDateTime* for SCTInst. "
        maxReferenceDateTime:
          $ref: '#/components/schemas/DateTime'
          description: "Maximum reference date and time. It cannot exceed 3 days from *minReferenceDateTime*.\r\nReference Date Time must be intended as *settlementDate* for SCT and *acceptanceDateTime* for SCTInst. "
        minGeneralRiskIndicator:
          type: number
          description: |
            Minimum value admitted as General Risk Indicator (model
            *FPAD_RIA_RiskIndicator*).
        maxGeneralRiskIndicator:
          type: number
          description: |
            Maximum value admitted as General Risk Indicator (model
            *FPAD_RIA_RiskIndicator*).
    TransactionKey:
      type: object
      description: Basic structure with all key elements identifìying a transaction.
      properties:
        serviceType:
          $ref: '#/components/schemas/ServiceType'
          description: EBA CLEARING Service type associated with the transaction.
        debtorBic:
          $ref: '#/components/schemas/Bic'
          description: BIC of the Agent managing the Debtor's Account.
        transactionId:
          type: string
          description: 'Identifier of the transaction, unique for the Debtor''s Agent. '
          maxLength: 35
        referenceDateTime:
          $ref: '#/components/schemas/DateTime'
          description: |
            This attribute refers to:

            - Settlement date for SCT service type. If time is provided, it will
            be ignored.

            - Acceptance date and time for SCTInst service type. If time is
            missing, in this case, an error will be returned.
      required:
        - serviceType
        - debtorBic
        - transactionId
        - referenceDateTime
      title: ''
      examples:
        - serviceType: SCT
          debtorBic: FPADITMMXXX
          transactionId: 41e400e45
          referenceDateTime: '2019-08-24T14:15:22Z'
    VerificationOfPayeeResponse:
      description: | 
        Separation of the two kinds of responses in different structures allows constraints on code identification results and name inclusion.
        Mutual exclusion is verified by business rules executed after the json parsing.
        If the result of partyNameMatch is CMTC, then matchedName is mandatory and can only be used in this case.
      type: object
      properties:
        partyNameMatch:
          $ref: '#/components/schemas/NameMatchType'
        partyIdMatch:
          $ref: '#/components/schemas/PartyIdMatchType'
        matchedName:
          $ref: '#/components/schemas/Max140Text'
    VerificationOfPayeeError:
      type: object
      properties:
        type: 
          $ref: '#/components/schemas/Max70Text'
        code:
          description: An entry provided by an external ISO code list.
          allOf:
            - $ref: '#/components/schemas/MessageCode'
        title:
          $ref: '#/components/schemas/Max70Text'
        status:
          type: integer
          enum: [400,401,500]
        detail:
          $ref: '#/components/schemas/Max500Text'
        instance:
          $ref: '#/components/schemas/Max256Text'
      required:
        - type
        - code
    VerificationOfPayeeRequest:
      type: object
      properties:
        party:
          $ref: '#/components/schemas/PartyType'
        partyAccount: 
          $ref: '#/components/schemas/AccountType'
        partyAgent: 
          $ref: '#/components/schemas/AgentType'
        unstructuredRemittanceInformation:
          description: | 
            Additional information about AT-C001 sent by the Requester AT-C007, 
            Usage Rule: only one entry may be used.
          type: array
          items:
            $ref: '#/components/schemas/Max140Text'
        requestingAgent: 
          $ref: '#/components/schemas/AgentType'
      required:
        - party
        - partyAccount
        - partyAgent
        - requestingAgent
    VopBulkIdentification:
      type: object
      title: ''
      description: This object contains all info about the *identification* block of a VOP bulk request
      properties:
        lei:
          description: Legal Entity Identifier of the party
          $ref: '#/components/schemas/LEIType'
        bic:
          description: BIC of the party
          $ref: '#/components/schemas/BICType'
        id:
          description: |
            Identification: unique and unambiguous identification of an organisation.
          $ref: '#/components/schemas/Max256Text'
        snc:
          description: |
            Scheme Name Code: an entry provided by an external ISO code list.
          $ref: '#/components/schemas/OrganisationIdentificationCode'
        snp:
          description: |
            Scheme Name Proprietary: a scheme name defined in a proprietary way.
          $ref: '#/components/schemas/Max35Text'
        iss:
          description: Issuer of the identification.
          $ref: '#/components/schemas/Max35Text'
    VopBulkRequest:
      type: object
      title: ''
      description: This object contains all fields to make request for a bulk vop
      properties:
        xid:
          type: string
          format: uuid
          description: X-Request-ID used as Requesting PSP’s reference number in the VOP Request (T054).
        rBic:
          description: BIC of the requesting agent
          $ref: '#/components/schemas/BICType'
        pBic:
          description: BIC of the party agent
          $ref: '#/components/schemas/BICType'
        iban:
          description: IBAN of the party account
          $ref: '#/components/schemas/IBANType'
        name:
          description: Party name
          $ref: '#/components/schemas/Max140Text'
        id:
          description: Party identification (may be used as an alternative to party name, not in combination) 
          type: array
          items: 
            $ref: '#/components/schemas/VopBulkIdentification'
      required:
        - xid
        - rBic
        - pBic
        - iban
    VopBulkResponse:
      description: This object contains the reponse of a get bulk vop
      type: object
      title: ''
      properties:
        xid:
          type: string
          format: uuid
          description: |
            X-Request-ID used as Requesting PSP’s reference number in the VOP Request (T054).
            It can be used to match a request with a response in the bulk request.
        fuid:
          type: string
          description: FPAD Unique Identifier (a UUID specified by RFC4122).
        fName:
          type: string
          description: FPAD Payee Name.
        ria:
          type: array
          items: 
            $ref: '#/components/schemas/Ria'
        vPnm:
          description: VOP Party Name Match.
          $ref: '#/components/schemas/NameMatchType'
        vPim:
          description: VOP Party Id Match.
          $ref: '#/components/schemas/PartyIdMatchType'
        vName:
          description: VOP matched name.
          $ref: '#/components/schemas/Max140Text'
        msgs:
          type: array
          description: Messages array.
          items: 
            $ref: '#/components/schemas/ShortMessage'
        vrts:
          type: string
          format: date-time
          description: |
            VOP Response Time Stamp: Time stamp of provided by the responding PSP **(T061)**.
          examples:
            - 2024-08-12T15:19:22.678Z
      required:
        - xid
        - fuid
    VopBulkResponseCounter:
        description: Counter for bulk responses having the same matching result.
        type: object
        properties:
          matchingResult:
            description: |
              Matching value for successful responses, "ERROR" for responses returning 4xx/5xx status codes.
            type: string
            enum:
              - MTCH
              - CMTC
              - NMTC
              - NOAP
              - ERROR
          counter:
            description: Number of responses having the matching value specified in *matchingResult*.
            type: integer
  responses:
    ErrorResponse_401:
      description: |
        Structure describing FPAD error response for HTTP code 401.
      headers:
        fri:
          $ref: '#/components/headers/FpadResponseIdentifier'
      x-sandbox-request-name: OK
      x-sandbox-request-headers:
        senderBic: FPADITMM
        pri: a206e009-ef37-4040-924d-db758b29b401
      content:
        text/plain:
          schema:
            type: string
            description: Error message
          examples:
            Unauthorized:
              value: Unauthorized
    ErrorResponse_403:
      description: |
        Structure describing FPAD error response for HTTP code 403.
      headers:
        fri:
          $ref: '#/components/headers/FpadResponseIdentifier'
      x-sandbox-request-name: OK
      content:
        text/plain:
          schema:
            type: string
            description: Error message
          examples:
            Forbidden:
              x-sandbox-response-name:
                Forbidden
              x-sandbox-request-headers:
                senderBic: FPADITMM
                pri: a206e009-ef37-4040-924d-db758b29a403
              value: Forbidden
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            Forbidden (application managed):
              x-sandbox-response-name:
                Forbidden (application managed)
              x-sandbox-request-headers:
                senderBic: FPADITMM
                pri: a206e009-ef37-4040-924d-db758b29b403
              value:
                errors:
                  - dateTime: 2023-07-20T14:15:22Z
                    code: E403
                    description: The provided sender BIC is not authorized to perform this action.
    ErrorResponse_404:
      description: |
        Structure describing FPAD error response for HTTP code 404.
      headers:
        fri:
          $ref: '#/components/headers/FpadResponseIdentifier'
      x-sandbox-request-name: OK
      x-sandbox-request-headers:
        senderBic: FPADITMM
        pri: a206e009-ef37-4040-924d-db758b29b404
      content:
        text/plain:
          schema:
            type: string
            description: Error message
          examples:
            Not Found:
              value: Not Found
    ErrorResponse_409:
      description: |
        Structure describing FPAD error response for HTTP code 409.
      headers:
        fri:
          $ref: '#/components/headers/FpadResponseIdentifier'
      x-sandbox-request-name: OK
      x-sandbox-request-headers:
        senderBic: FPADITMM
        pri: a206e009-ef37-4040-924d-db758b29b409
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            Conflict:
              value:
                errors:
                  - dateTime: 2023-07-20T14:15:22Z
                    code: E409
                    description: The same PRI has already been sent.
    ErrorResponse_429:
      description: |
        Structure describing FPAD error response for HTTP code 429.
      headers:
        fri:
          $ref: '#/components/headers/FpadResponseIdentifier'
      x-sandbox-request-name: OK
      x-sandbox-request-headers:
        senderBic: FPADITMM
        pri: a206e009-ef37-4040-924d-db758b29b429
      content:
        text/plain:
          schema:
            type: string
            description: Error message
          examples:
            Too many requests:
              value: Too many requests
    ErrorResponse_500:
      description: |
        Structure describing FPAD error response for HTTP code 500.
      headers:
        fri:
          $ref: '#/components/headers/FpadResponseIdentifier'
      x-sandbox-request-name: OK
      content:
        text/plain:
          schema:
            type: string
            description: Error message
          examples:
            Generic Error:
              x-sandbox-response-name:
                Generic Error
              x-sandbox-request-headers:
                senderBic: FPADITMM
                pri: a206e009-ef37-4040-924d-db758b29a500
              value: Internal Server Error
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
          examples:
            Generic Error (application managed):
              x-sandbox-response-name:
                Generic Error (application managed)
              x-sandbox-request-headers:
                senderBic: FPADITMM
                pri: a206e009-ef37-4040-924d-db758b29b500
              value:
                errors:
                  - dateTime: 2023-07-20T14:15:22Z
                    code: E500
                    description: Application error.
