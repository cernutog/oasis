<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OASIS v2.0 - User Guide</title>
    <style>
        :root {
            --primary: #0A809E;
            --primary-hover: #076075;
            --bg: #f9fafb;
            --text: #333;
            --border: #ddd;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            max-width: 960px;
            margin: 0 auto;
            padding: 40px 20px;
            background-color: var(--bg);
        }

        header {
            border-bottom: 3px solid var(--primary);
            padding-bottom: 20px;
            margin-bottom: 40px;
        }

        h1 {
            color: var(--primary);
            margin: 0;
            font-size: 2.5em;
        }

        .subtitle {
            color: #666;
            font-size: 1.2em;
            font-weight: 300;
            margin-top: 5px;
        }

        section {
            margin-bottom: 50px;
            /* Default section style (will be overridden for hero) */
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        /* Hero Section Styling (Philosophy) */
        #philosophy {
            background: transparent;
            box-shadow: none;
            border: none;
            padding: 0 20px;
            text-align: center;
            max-width: 800px;
            margin: 0 auto 60px auto;
        }

        #philosophy h2 {
            display: none;
            /* Hide the standard "Philosophy" header, acts as Intro */
        }

        #philosophy p {
            font-size: 1.25em;
            font-weight: 300;
            color: #475569;
            line-height: 1.8;
        }

        /* Workflow Cards Grid - distinct from the flowing intro */
        .workflow-section {
            max-width: 960px;
            margin: 0 auto 60px auto;
        }

        h2 {
            color: #2c3e50;
            border-left: 5px solid var(--primary);
            padding-left: 15px;
            margin-top: 0;
        }

        h3 {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
            margin-top: 40px;
            font-size: 1.8em;
            font-weight: 600;
        }

        h4 {
            font-size: 1.3em;
            /* Slightly reduced to subordinate to H3 */
            color: #2c3e50;
            margin-top: 25px;
            margin-bottom: 12px;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            font-weight: 600;
        }

        h5 {
            font-size: 1.2em;
            /* Increased visibility */
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            border: 1px solid #eee;
        }

        .feature-card strong {
            color: var(--primary);
            display: block;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        code {
            background-color: #eef;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: Consolas, monospace;
            color: #0056b3;
            font-size: 0.9em;
        }

        ul {
            padding-left: 20px;
        }

        li {
            margin-bottom: 10px;
        }

        .note {
            background-color: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 4px 4px 0;
        }

        .tip {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 4px 4px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th,
        td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: #f1f1f1;
            color: #555;
        }

        footer {
            margin-top: 60px;
            border-top: 1px solid var(--border);
            padding-top: 30px;
            text-align: center;
            color: #888;
            font-size: 0.9em;
        }

        a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }

        a:hover {
            text-decoration: underline;
        }

        /* Interactive Image Container */
        .interactive-container {
            position: relative;
            width: 100%;
            margin-top: 15px;
            cursor: pointer;
            border-radius: 6px;
            overflow: hidden;
            /* Ensures border-radius crops content */
            border: 1px solid #ddd;
            /* Box-shadow inheritance */
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .interactive-container img.anim {
            width: 100%;
            display: block;
        }

        .interactive-container img.static {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 0.3s ease;
            z-index: 2;
            /* Sits on top */
        }

        /* Hover Effect: Hide static, reveal GIF */
        .interactive-container:hover img.static {
            opacity: 0;
        }

        /* Print Optimization */
        @media print {
            body {
                background: white;
                max-width: 100%;
                margin: 0;
                padding: 0;
            }

            section {
                box-shadow: none !important;
                border: none !important;
                padding: 0 !important;
                margin-bottom: 30px !important;
            }

            /* Workflow Grid: Center items if they wrap, or fit if possible */
            .feature-grid {
                display: flex !important;
                flex-wrap: wrap;
                justify-content: center;
                gap: 20px;
            }

            .feature-card {
                flex: 1 1 30%;
                /* Try to fit 3 in a row */
                min-width: 200px;
                /* Allow shrinking for print */
                box-shadow: none !important;
                border: 1px solid #ddd !important;
                page-break-inside: avoid;
            }

            /* Animations */
            .interactive-container img.anim {
                display: none !important;
            }

            .interactive-container img.static {
                opacity: 1 !important;
                visibility: visible !important;
            }

            /* Hide hints in print */
            .hover-hint {
                display: none !important;
            }

            /* Force page break for Interface Reference */
            #interface {
                page-break-before: always;
            }

            /* Prevent images from splitting - Apply to parent container too */
            img,
            .interactive-container,
            table,
            tr {
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            /* Hide modal controls elements if they accidentally show up */
            .modal,
            .controls,
            .close {
                display: none !important;
            }
        }

        /* Hover Hint Badge */
        .hover-hint {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            pointer-events: none;
            z-index: 10;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            backdrop-filter: blur(2px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Hide hint on hover */
        .interactive-container:hover .hover-hint {
            opacity: 0;
        }

        /* Global Img Shadow Update (Exclude interactive and header logo) */
        img:not(.static):not(.anim):not(.header-logo) {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s ease-in-out;
            cursor: pointer;
        }

        img:hover {
            transform: scale(1.01);
        }

        /* Scroll Lock for body */
        body.modal-open {
            overflow: hidden;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            /* Flexbox Centering */
            flex-direction: column;
            justify-content: center;
            align-items: center;

            background-color: rgb(0, 0, 0);
            background-color: rgba(0, 0, 0, 0.9);
        }

        .modal-content {
            display: block;
            width: auto;
            height: auto;
            max-width: 95%;
            max-height: 95vh;
            object-fit: contain;
            border-radius: 4px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
            animation-name: zoom;
            animation-duration: 0.3s;
        }

        @keyframes zoom {
            from {
                transform: scale(0.1)
            }

            to {
                transform: scale(1)
            }
        }

        /* Zoom Toggle State */
        .modal-content.zoomed {
            width: auto;
            max-width: none;
            max-height: none;
            cursor: zoom-out;
            margin: 0 auto;
        }

        .close {
            position: absolute;
            top: 20px;
            right: 30px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 30px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
            z-index: 1001;

            /* Button Style */
            background: rgba(0, 0, 0, 0.4);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            line-height: 1;
            padding-bottom: 4px;
        }

        .close:hover,
        .close:focus {
            color: white;
            background: rgba(0, 0, 0, 0.6);
            text-decoration: none;
            cursor: pointer;
        }

        /* Projector Controls */
        .controls {
            position: fixed;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.4);
            /* Lighter background as requested */
            padding: 12px 25px;
            border-radius: 40px;
            /* Pill shape */
            display: flex;
            gap: 20px;
            z-index: 1001;
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: opacity 0.3s, background 0.3s;
        }

        .controls:hover {
            background: rgba(0, 0, 0, 0.6);
        }

        .control-btn {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.8);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.2s;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .control-btn:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        /* Image Stack for Overlapping Effect */
        .image-stack {
            position: relative;
            width: 340px;
            height: 240px;
            margin-right: 30px;
            flex-shrink: 0;
        }

        .image-stack img {
            position: absolute;
            background: white;
            transition: transform 0.3s, z-index 0.3s;
            border-radius: 6px;
        }

        .image-stack .main-img {
            top: 0;
            left: 0;
            width: 280px;
            z-index: 1;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            border: 1px solid #ddd;
        }

        .image-stack .secondary-img {
            bottom: -25px;
            /* Much lower */
            right: -40px;
            /* Further right */
            top: auto;
            width: 200px;
            z-index: 2;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
            border: 1px solid #ccc;
        }

        .image-stack:hover .secondary-img {
            transform: scale(1.05);
            /* Gentle lift on hover */
        }
    </style>
    <link rel="icon" href="assets/favicon.ico" type="image/x-icon">
</head>

<body>

    <header style="text-align: center; border-bottom: none; margin-bottom: 30px; padding-top: 60px;">
        <!-- Centered Container for O-ASIS -->
        <!-- Increased negative margin-left to -40px to shift the whole block left optically (slightly less than before) -->
        <div
            style="display: flex; align-items: center; justify-content: center; margin-bottom: 15px; margin-left: -40px;">
            <!-- Logo Image (The 'O') -->
            <img src="assets/logo.png" alt="OASIS Logo" class="header-logo"
                style="height: 155px; margin-right: -35px; position: relative; z-index: 2; transform: translateY(11px) translateX(-2px);">

            <!-- Gradient Text ('ASIS') -->
            <div
                style="font-family: 'Segoe UI Light', 'Segoe UI', sans-serif; font-size: 130px; line-height: 1; font-weight: 300; background: linear-gradient(45deg, #055a78, #28c8dc); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-left: 0;">
                ASIS</div>
        </div>

        <div class="subtitle"
            style="font-family: 'Segoe UI', sans-serif; font-size: 2em; color: #334155; letter-spacing: 0.5px; font-weight: 300;">
            OAS Integration Suite</div>
        <div
            style="color: #94A3B8; margin-top: 10px; font-family: 'Segoe UI', sans-serif; font-size: 1.1em; letter-spacing: 1px; text-transform: uppercase;">
            Official User Guide v2.0</div>
    </header>

    <!-- Seamless Intro Section (Was Philosophy) -->
    <section id="philosophy">
        <!-- Hidden h2, effectively the intro text -->
        <p>
            OASIS adopts an <strong>"Excel First"</strong> approach to API design. <br>
            It democratizes API specification by treating Excel templates as the <em>"Source of Truth"</em>,<br>
            enabling Functional Analysts to define properties, endpoints, and validation logic<br>
            without managing complex YAML files directly.
        </p>
    </section>

    <!-- Workflow Cards (Now outside the text section for visual break) -->
    <div class="workflow-section">
        <!-- Re-adding the 'The Workflow' title as a subtle label -->
        <div
            style="text-align: center; margin-bottom: 30px; color: #94a3b8; font-weight: 600; letter-spacing: 1px; text-transform: uppercase; font-size: 0.9em;">
            Core Workflow</div>

        <div class="feature-grid">
            <div class="feature-card">
                <strong>1. Migration (One-Shot)</strong>
                <p>Use the <em>OAS to Excel</em> tab to reverse-engineer existing JSON/YAML specifications into editable
                    Excel templates. This is typically done once to initialize the project.</p>
            </div>
            <div class="feature-card">
                <strong>2. Design (Daily)</strong>
                <p>Analysts work exclusively in the Excel templates. You add endpoints, modify schemas, and define
                    validations using familiar spreadsheet columns.</p>
            </div>
            <div class="feature-card">
                <strong>3. Generation (Daily)</strong>
                <p>Use the <em>Excel to OAS</em> tab to compile your Excel work into validated, standards-compliant OAS
                    3.0 and 3.1 specifications.</p>
            </div>
        </div>
    </div>
    </div>

    <section id="interface">
        <h2>Interface Reference</h2>

        <h3>Global Navigation</h3>
        <ul>
            <li><strong>Tabs:</strong> switch between the four main modes: <em>OAS to Excel</em>, <em>Excel to OAS</em>,
                <em>Validation</em>, and <em>View</em>.
            </li>
            <li><strong>Menu Bar:</strong>
                <ul>
                    <li><strong>File:</strong> Context-aware "Smart Select" that opens the relevant folder chooser based
                        on your active tab.</li>
                    <li><strong>View:</strong> Access to all application tabs (Import, Generation, Validation, View) and
                        <em>Application Logs</em> (detached window).</li>
                    <li><strong>Edit:</strong> Open the <em>Preferences</em> dialog.</li>
                </ul>
            </li>
        </ul>



        <h3>Tab 1: OAS to Excel (Import)</h3>
        <p>Used for migrating legacy specs to the OASIS format.</p>
        <img src="assets/tab1.png" alt="Tab 1 Interface"
            style="width: 100%; border-radius: 6px; border: 1px solid #ddd; margin: 15px 0;">
        <ul>
            <li><strong>Source File/Folder:</strong> Select a single `.yaml/.json` file or a folder of specs.</li>
            <li><strong>Output Folder:</strong> Where the generated `.xlsx` templates will be saved.</li>
            <li><strong>Import Button:</strong> Starts the reverse-engineering process. It generates an
                <code>$index.xlsx</code> (global metadata) and individual endpoint files.
            </li>
        </ul>

        <h4>Import & Roundtrip Log Reference</h4>
        <p>The internal log area in this tab provides detailed feedback during operations.</p>

        <h5>1. Import Process</h5>
        <p>Tracks file generation:</p>
        <img src="assets/tab1_import_process.png" alt="Import Process Log"
            style="width: 100%; max-width: 600px; border-radius: 6px; border: 1px solid #ddd; margin: 15px 0;">
        <ul>
            <li><strong>Step 1:</strong> Index creation ($index.xlsx).</li>
            <li><strong>Step 2:</strong> Endpoint file creation.</li>
            <li><strong>Validation:</strong> Reports success count or permission errors.</li>
        </ul>

        <h5>2. Roundtrip Check (Audit)</h5>
        <p>The <strong>Roundtrip Check</strong> compiles your <em>newly created</em> Excel templates back into a
            temporary OAS file and compares it against your <em>original source</em> to ensure "Lossless Migration".</p>

        <div style="margin: 20px 0;">
            <p style="margin-bottom: 5px;"><strong>1. Standard (Structure Only):</strong></p>
            <p style="font-size: 0.9em; color: #666; margin-bottom: 10px;">Compacts validation into a clean summary
                table.</p>
            <img src="assets/log_roundtrip_nodiff.png" alt="Roundtrip Log - Structure Only"
                style="width: 100%; max-width: 700px; border-radius: 6px; border: 1px solid #ddd; margin-bottom: 25px;">

            <p style="margin-bottom: 5px;"><strong>2. Forensic (Line Diff Enabled):</strong></p>
            <p style="font-size: 0.9em; color: #666; margin-bottom: 10px;">Expands to show detailed line-by-line
                comparison and per-component breakdown.</p>
            <img src="assets/log_roundtrip.png" alt="Roundtrip Log - With Line Diff"
                style="width: 100%; max-width: 700px; border-radius: 6px; border: 1px solid #ddd;">
        </div>

        <ul>
            <li><strong>Structure Summary:</strong> Compares high-level object counts. Match (✓) = 100% Structural
                Fidelity.</li>
            <li><strong>Line Diff (Forensic Audit):</strong> If enabled, compares the exact YAML line count.</li>
        </ul>

        <div style="background: #f8f9fa; border-left: 4px solid #17a2b8; padding: 15px; margin: 15px 0;">
            <strong>Understanding Differences:</strong>
            <ul style="margin-top: 5px; margin-bottom: 0;">
                <li><strong>Perfect Match (✓ / 0 Delta):</strong> No differences found.</li>
                <li><strong>Physiological Delta (Variable):</strong> Common and usually benign. The acceptable range
                    depends on the component's size and description verbosity. For example, a large schema with many
                    text fields might show a delta of ±15-20 lines purely due to how YAML wraps text.</li>
                <li><strong>Structural Mismatch (Significant Delta):</strong> If a delta is disproportionately large
                    relative to the component size, it may indicate a dropped construct (e.g., an unsupported keyword).
                    Use the line count to target these specific discrepancies.</li>
            </ul>
        </div>

        <h3>Tab 2: Excel to OAS (Generation)</h3>
        <p>The main engine for compiling your work.</p>
        <img src="assets/tab2.png" alt="Tab 2 Interface"
            style="width: 100%; border-radius: 6px; border: 1px solid #ddd; margin: 15px 0;">
        <ul>
            <li><strong>Template Folder:</strong> The directory containing your <code>$index.xlsx</code> and endpoint
                `.xlsx` files.</li>
            <li><strong>OAS Output Folder:</strong> Where the final specs will be generated.</li>
            <li><strong>Version Toggles:</strong>
                <ul>
                    <li><code>OAS 3.1</code> / <code>OAS 3.0</code>: <strong>Multi-select.</strong> Choose one or both
                        versions. If both are selected, the tool generates two separate specification files
                        simultaneously.</li>
                    <li><code>OAS SWIFT</code>: Generates <strong>additional</strong> OAS outputs specifically
                        customized
                        for SWIFT integration. These files include the metadata <code>x-info-customization: SWIFT</code>
                        in the Info section, alongside your standard 3.0/3.1 files.</li>
                </ul>
            </li>
            <li><strong>Font Size:</strong> Logic slider (8-24px) to adjust the readability of the real-time log
                console.</li>
        </ul>

        <h4>Generation Log Reference</h4>
        <p>The console provides real-time feedback on the generation process, including confirmation of specific version
            outputs (3.0, 3.1, SWIFT).</p>
        <img src="assets/tab2_generation_log.png" alt="Generation Log Output"
            style="width: 100%; border-radius: 6px; border: 1px solid #ddd; margin: 15px 0;">

        <h4>Advanced: Custom Filename Patterns</h4>
        <p>You can customize the naming convention of the generated files by defining a <code>filename pattern</code> in
            the <strong>General Description</strong> sheet of your <code>$index.xlsx</code>.</p>

        <img src="assets/filename_pattern_excel.png" alt="Filename Pattern Configuration"
            style="width: 100%; border-radius: 6px; border: 1px solid #ddd; margin: 15px 0;">

        <p>Supported placeholders (enclosed in angle brackets):</p>
        <ul>
            <li><code>&lt;current_date&gt;</code>: The current date (Format: YYYYMMDD).</li>
            <li><code>&lt;oas_version&gt;</code>: Returns "3.0" or "3.1".</li>
            <li><code>&lt;customization&gt;</code>: Returns "_SWIFT" (if SWIFT OAS is generated) or an empty string.
            </li>
            <li><code>&lt;api_version&gt;</code>: Taken from the <code>info version</code> field (e.g., "5.0.8").</li>
            <li><code>&lt;release&gt;</code>: Taken from the <code>release</code> field (e.g., "v20260418").</li>
        </ul>

        <p><strong>Example Output:</strong></p>
        <img src="assets/filename_pattern_log.png" alt="Custom Filename Log Output"
            style="width: 100%; border-radius: 6px; border: 1px solid #ddd; margin: 15px 0;">

        <h3>Tab 3: Validation</h3>
        <p>Post-generation quality assurance.</p>
        <!-- Interactive Tab 3 Video (Hover to Play) -->
        <div class="interactive-container" style="margin: 15px 0;">
            <video width="100%" muted loop playsinline poster="assets/tab3.png" class="anim">
                <source src="assets/Validation.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <!-- Visual Hint -->
            <div class="hover-hint">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
                Hover to play animation
            </div>
            <script>
                document.addEventListener('DOMContentLoaded', () => {
                    const containers = document.querySelectorAll('.interactive-container');
                    containers.forEach(container => {
                        const video = container.querySelector('video');
                        if (video) {
                            container.addEventListener('mouseenter', () => video.play());
                            container.addEventListener('mouseleave', () => {
                                video.pause();
                                // Paused, will resume from current frame next time
                            });
                        }
                    });
                });
            </script>
        </div>

        <h4>1. Controls & Configuration</h4>
        <ul>
            <li><strong>OAS Folder:</strong> The directory containing your generated specification files.</li>
            <li><strong>Select File:</strong> Dropdown list of all OAS files found in the folder (sorted by modification
                time).</li>
            <li><strong>Refresh Button (↻):</strong> Reloads the file list. Use this if you have generated new files or
                modified the folder contents externally.</li>
            <li><strong>Ignore 'Bad Request' Examples:</strong>
                <p style="margin-top: 5px; font-size: 0.95em; color: #555;">
                    When checked, the validator skips errors in examples named <code>Bad Request</code>.
                    <br>
                    <strong>Context:</strong> These examples are intentionally malformed to support the <strong>API
                        Developer Portal Playground</strong> (simulating 400 responses). Enabling this option prevents
                    them from being flagged as semantic errors.
                </p>
            </li>
        </ul>

        <h4>2. Semantic Pie Chart</h4>
        <div style="display: flex; align-items: flex-start; margin-bottom: 20px;">
            <!-- Overlapping Images (Restored) -->
            <div class="image-stack">
                <img src="assets/pie_chart.png" alt="Validation Pie Chart" class="main-img">
                <img src="assets/spectral_doc.png" alt="Spectral Documentation Pop-up" class="secondary-img">
            </div>

            <div style="margin-left: 30px;">
                <p>An interactive visual breakdown of validation results.</p>
                <ul style="list-style-type: disc; padding-left: 20px;">
                    <li><strong>Colors:</strong> Shades of Red (Errors), Shades of Amber (Warnings).</li>
                    <li><strong>Interactivity:</strong>
                        <ul style="list-style-type: circle;">
                            <li><strong>Hover:</strong> Hovering over a slice displays a tooltip with the exact count
                                and the rule's description.</li>
                            <li><strong>Click:</strong> Clicking a slice opens the <strong>Spectral Rule
                                    Documentation</strong> (shown in overlay) for that specific error type.</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <h4 style="margin-top: 60px;">3. Issues List</h4>
        <div style="display: flex; align-items: start; gap: 20px; margin-bottom: 20px;">
            <img src="assets/issue_card.png" alt="Issue Card Detail"
                style="width: 350px; border-radius: 6px; border: 1px solid #ddd;">
            <div>
                <p>A detailed, clickable card list of all findings.</p>
                <ul>
                    <li><strong>Issues Card:</strong> Displays Severity, Error Code, Path, and Message.</li>
                    <li><strong>"Line [N]" Button:</strong> Jumps directly to the <strong>View Tab</strong>, loads the
                        file, scrolls to the exact line, and highlights it for inspection.</li>
                    <li><strong>"Template Sheet" Button:</strong> (If available) Opens the source Excel file directly to
                        the relevant sheet, allowing you to fix the error at the source immediately.</li>
                </ul>
            </div>
        </div>

        <h4>4. Spectral Log</h4>
        <p>A collapsible section at the bottom showing the raw JSON output from the Spectral linter process.
            Useful for debugging configuration issues or "Spectral not found" errors.</p>

        <div style="margin: 20px 0;">
            <img src="assets/spectral_log.png" alt="Spectral Log Output"
                style="width: 100%; border-radius: 6px; border: 1px solid #ddd;">
        </div>

        <h3>Tab 4: View (YAML & Docs)</h3>
        <p>Technical inspection and final preview.</p>

        <!-- Interactive Tab 4 Image (Hover to Animate) -->
        <div class="interactive-container" style="margin: 15px 0;">
            <!-- Animated GIF (Bottom Layer) -->
            <!-- Animated Video (Bottom Layer) -->
            <video width="100%" muted loop playsinline class="anim">
                <source src="assets/tab4_animation.mp4" type="video/mp4">
            </video>
            <!-- Static Image (Top Layer) -->
            <img src="assets/tab4.png" alt="Tab 4 Interface (Static)" class="static">
            <!-- Visual Hint -->
            <div class="hover-hint">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
                Hover to play animation
            </div>
        </div>
        <h4>1. YAML Editor</h4>
        <ul>
            <li><strong>Syntax Highlighting:</strong> Read-only editor optimized for large OAS files.</li>
            <li><strong>Toolbar:</strong>
                <ul>
                    <li>Customize appearance (Theme/Font) instantly.</li>
                    <li><strong>Locate in Docs:</strong> Scroll the HTML documentation to the endpoint corresponding to
                        your current cursor position (based on the nearest <code>operationId</code>).</li>
                </ul>
            </li>
            <li><strong>Shortcuts:</strong>
                <ul>
                    <li><strong>Text Find (Ctrl+F):</strong> Search text within the code editor.</li>
                </ul>
            </li>
        </ul>

        <h4>2. Documentation Viewer (Redocly)</h4>
        <div style="display: flex; gap: 30px; align-items: flex-start; margin-top: 20px;">
            <img src="assets/doc_viewer.png" alt="Documentation Viewer"
                style="width: 500px; border-radius: 6px; border: 1px solid #ddd; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">

            <div>
                <p>Renders your API as a professional HTML page using Redocly.</p>

                <h5>Commands</h5>
                <ul style="list-style-type: disc; padding-left: 20px;">
                    <li><strong>Dock/Undock:</strong> Toggles the docking mechanism. Attaches the viewer to the right of
                        the main window for easy comparison, or detaches it into a floating window.</li>
                    <li><strong>Find in YAML:</strong> Syncs the view. Click a section in the docs to locate the
                        corresponding definition in the YAML editor.</li>
                    <li><strong>Save to HTML:</strong> Exports the current documentation as a standalone
                        <code>.html</code> file.
                    </li>
                </ul>

                <h5>Docking Behavior</h5>
                <p style="font-size: 0.95em; color: #555;">
                    By default, the viewer is <strong>Docked</strong> to the right.
                    You can disable this permanently in <em>Preferences</em>, or temporarily by clicking the
                    <strong>Undock</strong> button.
                </p>
            </div>
        </div>
    </section>

    <section id="custom-extensions">
        <h2>Custom Extensions</h2>
        <p>OASIS supports "Custom Metadata Extensions" to provide additional context for humans or applications (like
            Developer Portals) that isn't covered by the standard OAS specification.</p>

        <table>
            <tr>
                <th>Extension</th>
                <th>Description</th>
                <th>Usage</th>
            </tr>
            <tr>
                <td style="white-space: nowrap;"><code>x-sandbox-*</code></td>
                <td><strong>Playground Metadata</strong>. Family of extensions used by the API Developer Portal to
                    generate simulated
                    responses in the API Playground.</td>
                <td>Defined in Excel via indented blocks.</td>
            </tr>
            <tr>
                <td style="white-space: nowrap;"><code>x-info-*</code></td>
                <td><strong>General Metadata</strong>. Family of extensions containing release tracking info, creation
                    date, and versioning
                    details.</td>
                <td>Auto-generated by OASIS during compilation.</td>
            </tr>
            <tr>
                <td><code>x-comment</code></td>
                <td><strong>Analyst Comments</strong>. Propagates descriptions or notes from Excel references that
                    override the standard definition.</td>
                <td>Auto-generated when a Reference in Excel has a custom Description.</td>
            </tr>
        </table>
    </section>



    <section id="preferences">
        <h2>Preferences</h2>
        <p>
            The Preferences window allows you to customize the application's behavior and appearance.
            You can access it via <strong>Edit > Preferences</strong>.
        </p>

        <!-- Preferences Split Layout -->
        <div style="display: flex; gap: 40px; align-items: flex-start; margin-top: 30px; margin-bottom: 40px;">

            <!-- Left Column: Animation (Reduced width) -->
            <div style="flex: 0 0 480px;">
                <div class="interactive-container"
                    style="margin-bottom: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border-radius: 8px;">
                    <!-- Animated GIF -->
                    <!-- Animated Video -->
                    <video width="100%" muted loop playsinline class="anim"
                        style="width: 100%; border-radius: 8px; display: block;">
                        <source src="assets/preferences_animation.mp4" type="video/mp4">
                    </video>
                    <!-- Static Image -->
                    <img src="assets/preferences_static.png" alt="Preferences Workflow (Static)" class="static"
                        style="width: 100%; border-radius: 8px; display: block;">
                    <!-- Visual Hint -->
                    <div class="hover-hint">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="5 3 19 12 5 21 5 3"></polygon>
                        </svg>
                        Hover to play
                    </div>
                </div>
                <!-- Caption Removed -->
            </div>

            <!-- Right Column: Description -->
            <div style="flex: 1; min-width: 300px;">
                <p style="margin-top: 0; font-size: 1.1em; color: #334155; margin-bottom: 15px;"><strong>Available
                        options:</strong></p>
                <ul style="padding-left: 20px; color: #475569; line-height: 1.6;">
                    <li><strong>Paths</strong>: Define default folders for Templates and OAS output to streamline your
                        daily workflow.</li>
                    <li><strong>Generation Defaults</strong>:
                        <ul style="margin-top: 5px; margin-bottom: 8px;">
                            <li>Select your target versions (<em>OAS 3.1, 3.0, SWIFT</em>) to be enabled by default.
                            </li>
                        </ul>
                    </li>
                    <li><strong>Validation</strong>:
                        <ul style="margin-top: 5px; margin-bottom: 8px;">
                            <li>Enable <em>Ignore 'Bad Request'</em> to skip playground error patterns automatically.
                            </li>
                        </ul>
                    </li>
                    <li><strong>View</strong>:
                        <ul style="margin-top: 5px; margin-bottom: 8px;">
                            <li>Customize the <em>YAML Viewer</em> font and theme.</li>
                            <li>Configure <em>Docking Behavior</em> for the documentation panel.</li>
                        </ul>
                    </li>
                    <li><strong>Logs</strong>:
                        <ul style="margin-top: 5px; margin-bottom: 8px;">
                            <li>Customize color themes for the <em>Application Logs</em> and <em>Spectral Console</em>.
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </section>

    <section id="console">
        <section id="console">
            <h2>Application Logs</h2>
            <p>Accessible via <strong>View > Application Logs</strong>, this detached window provides a comprehensive
                timeline of all application activities.</p>

            <img src="assets/app_console.png" alt="Application Logs Window"
                style="width: 100%; border-radius: 6px; border: 1px solid #ddd; margin: 15px 0;">

            <div>
                <p><strong>Features:</strong></p>
                <ul>
                    <li><strong>Timestamped Timeline:</strong> Every event is logged with precise timing
                        (<code>HH:MM:SS.mmm</code>).</li>
                    <li><strong>Unified View:</strong> consolidates logs from Import, Generation, and Validation in one
                        place.</li>
                    <li><strong>Traceability:</strong> Essential for verifying the sequence of bulk operations and
                        diagnosing issues.</li>
                </ul>
            </div>

        </section>



        <footer>
            <p>&copy; 2024-2026 OAS Integration Suite v2.0. Built with Google Antigravity.</p>
        </footer>

        <!-- Image Modal -->
        <div id="imgModal" class="modal">
            <span class="close" title="Close">&times;</span>
            <img class="modal-content" id="img01">
            <video class="modal-content" id="vid01" controls style="display:none; max-height: 90vh;"></video>

            <div class="controls">
                <button class="control-btn" onclick="zoomOut()" title="Zoom Out">-</button>
                <button class="control-btn" onclick="zoomIn()" title="Zoom In">+</button>
                <button class="control-btn" onclick="toggleFullScreen()" title="Full Screen">⛶</button>
            </div>
        </div>

        <script>
            var modal = document.getElementById("imgModal");
            var modalImg = document.getElementById("img01");
            var modalVid = document.getElementById("vid01");
            var currentScale = 1;

            // Open Modal
            var images = document.getElementsByTagName("img");
            for (var i = 0; i < images.length; i++) {
                if (images[i].id === "img01") continue;

                images[i].onclick = function () {
                    modal.style.display = "flex"; // Flex for centering
                    modalImg.style.display = "block";
                    modalVid.style.display = "none";
                    modalVid.pause();

                    // Smart Source Logic: If clicking a static overlay, load the animated content
                    if (this.classList.contains('static') && this.parentElement.classList.contains('interactive-container')) {
                        var animSibling = this.parentElement.querySelector('.anim');
                        if (animSibling) {
                            if (animSibling.tagName === 'VIDEO') {
                                // Sibling is Video -> Switch mode
                                modalImg.style.display = "none";
                                modalVid.style.display = "block";
                                var vSrc = animSibling.querySelector('source') ? animSibling.querySelector('source').src : animSibling.src;
                                modalVid.src = vSrc;
                                modalVid.play();
                            } else {
                                // Sibling is Image/GIF
                                modalImg.src = animSibling.src;
                            }
                        } else {
                            modalImg.src = this.src;
                        }
                    } else {
                        modalImg.src = this.src;
                    }

                    document.body.classList.add("modal-open"); // Lock scroll
                    resetZoom();
                }
            }

            // Open Modal (Videos)
            var videos = document.getElementsByTagName("video");
            for (var i = 0; i < videos.length; i++) {
                if (videos[i].id === "vid01") continue;

                videos[i].onclick = function (e) {
                    e.preventDefault(); // Prevent default controls if any
                    modal.style.display = "flex";
                    modalImg.style.display = "none";
                    modalVid.style.display = "block";
                    modalVid.src = this.querySelector('source') ? this.querySelector('source').src : this.src;
                    modalVid.play();
                    document.body.classList.add("modal-open");
                }
            }

            // Close functions
            document.getElementsByClassName("close")[0].onclick = function () {
                closeProjector();
            }

            function closeProjector() {
                modal.style.display = "none";
                modalVid.pause();
                modalVid.src = ""; // Stop buffering
                document.body.classList.remove("modal-open"); // Unlock scroll
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                }
            }

            // Zoom Logic
            function resetZoom() {
                currentScale = 1;
                updateTransform();
            }

            function zoomIn() {
                currentScale += 0.25;
                updateTransform();
            }

            function zoomOut() {
                if (currentScale > 0.5) {
                    currentScale -= 0.25;
                    updateTransform();
                }
            }

            function toggleFullScreen() {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().then(() => {
                        // Switch to Native Dimensions for clearer viewing
                        modalImg.style.maxWidth = "none";
                        modalImg.style.maxHeight = "none";
                        modalImg.style.width = "auto";
                        modalImg.style.height = "auto";
                        modalVid.style.maxWidth = "none";
                        modalVid.style.maxHeight = "none";
                        currentScale = 1;
                        updateTransform();
                    }).catch(err => {
                        console.error(`Error enabling full-screen mode: ${err.message}`);
                    });
                } else {
                    document.exitFullscreen();
                }
            }

            function updateTransform() {
                modalImg.style.transform = `scale(${currentScale})`;
                modalImg.style.cursor = currentScale > 1 ? "grab" : "default";

                // Also scale video if visible
                if (modalVid.style.display === "block") {
                    modalVid.style.transform = `scale(${currentScale})`;
                    modalVid.style.cursor = currentScale > 1 ? "grab" : "default";
                }
            }

            // Listen for fullscreen change to revert styles
            document.addEventListener("fullscreenchange", () => {
                if (!document.fullscreenElement) {
                    // Revert to "Fit" view
                    modalImg.style.maxWidth = "";
                    modalImg.style.maxHeight = "";
                    modalImg.style.width = "";
                    modalImg.style.height = "";
                    modalVid.style.maxWidth = "";
                    modalVid.style.maxHeight = "";
                    resetZoom();
                }
            });

            // Close on ESC
            document.onkeydown = function (evt) {
                evt = evt || window.event;
                if (evt.keyCode == 27) {
                    closeProjector();
                }
            };

            // Close when clicking background (but not controls or image)
            modal.onclick = function (event) {
                if (event.target === modal) {
                    closeProjector();
                }
            }
        </script>

</body>

</html>